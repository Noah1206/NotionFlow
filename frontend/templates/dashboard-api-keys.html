{% extends "base_dashboard.html" %}

{% block body_class %}api-keys-page{% endblock %}

{% block title %}API Keys - NotionFlow{% endblock %}

{% block description %}Connect NotionFlow with your favorite platforms for seamless calendar synchronization. All
credentials are encrypted and stored securely.{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/api-keys.css') }}">
{% endblock %}

{% block extra_js %}
{% endblock %}

{% block content %}
<!-- üîô Back to Dashboard Button -->
<div class="back-to-dashboard">
    <a href="/dashboard" class="back-btn" data-tooltip="ÎåÄÏãúÎ≥¥ÎìúÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="m15 18-6-6 6-6" />
        </svg>
        <span>Dashboard</span>
    </a>
</div>

<div class="api-container fade-in">
    <!-- üè¢ Professional Header Section -->
    <div class="api-hero api-hero-black">
        <div class="hero-icon">üîë</div>
        <h1>API Keys & Integrations</h1>
        <p>Manage platform connections and API credentials for enhanced workflow integration.
        </p>
    </div>
    <!-- üì± Enhanced Platforms Grid -->
    <div class="platforms-grid">
        <!-- Notion Card -->
        <div class="platform-card" id="notion-card">
            <div class="platform-header">
                <div class="platform-icon">
                    <span>N</span>
                </div>
                <div class="platform-info">
                    <h3>Notion</h3>
                    <p>Workspace Integration & Database Sync</p>
                </div>
            </div>

            <div class="platform-stats">
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Databases</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Pages</div>
                </div>
                <div class="stat-item">
                    <div class="status-indicator status-disconnected">
                        <span class="status-dot"></span>
                        <span>Offline</span>
                    </div>
                </div>
            </div>

            <div class="platform-actions">
                <button class="btn btn-primary" onclick="connectPlatformOneClick('notion')" data-platform="notion">
                    <span>‚ö°</span> One-Click Connect
                </button>
                <button class="btn btn-secondary" onclick="configurePlatform('notion')">
                    <span>‚öôÔ∏è</span> Configure
                </button>
            </div>
        </div>

        <!-- Google Calendar Card -->
        <div class="platform-card" id="google-card">
            <div class="platform-header">
                <div class="platform-icon">
                    <span>G</span>
                </div>
                <div class="platform-info">
                    <h3>Google Calendar</h3>
                    <p>Calendar Events & Scheduling Sync</p>
                </div>
            </div>

            <div class="platform-stats">
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Events</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Calendars</div>
                </div>
                <div class="stat-item">
                    <div class="status-indicator status-disconnected">
                        <span class="status-dot"></span>
                        <span>Offline</span>
                    </div>
                </div>
            </div>

            <div class="platform-actions">
                <button class="btn btn-primary" onclick="connectPlatformOneClick('google')" data-platform="google">
                    <span>‚ö°</span> One-Click Connect
                </button>
                <button class="btn btn-secondary" onclick="configurePlatform('google')">
                    <span>‚öôÔ∏è</span> Configure
                </button>
            </div>
        </div>

        <!-- Slack Card -->
        <div class="platform-card" id="slack-card">
            <div class="platform-header">
                <div class="platform-icon">
                    <span>S</span>
                </div>
                <div class="platform-info">
                    <h3>Slack</h3>
                    <p>Team Communication & Notifications</p>
                </div>
            </div>

            <div class="platform-stats">
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Channels</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Messages</div>
                </div>
                <div class="stat-item">
                    <div class="status-indicator status-disconnected">
                        <span class="status-dot"></span>
                        <span>Offline</span>
                    </div>
                </div>
            </div>

            <div class="platform-actions">
                <button class="btn btn-primary" onclick="connectPlatformOneClick('slack')" data-platform="slack">
                    <span>‚ö°</span> One-Click Connect
                </button>
                <button class="btn btn-secondary" onclick="configurePlatform('slack')">
                    <span>‚öôÔ∏è</span> Configure
                </button>
            </div>
        </div>

        <!-- Outlook Card -->
        <div class="platform-card" id="outlook-card">
            <div class="platform-header">
                <div class="platform-icon">
                    <span>O</span>
                </div>
                <div class="platform-info">
                    <h3>Outlook</h3>
                    <p>Email & Calendar Integration</p>
                </div>
            </div>

            <div class="platform-stats">
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Emails</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Events</div>
                </div>
                <div class="stat-item">
                    <div class="status-indicator status-disconnected">
                        <span class="status-dot"></span>
                        <span>Offline</span>
                    </div>
                </div>
            </div>

            <div class="platform-actions">
                <button class="btn btn-primary" onclick="connectPlatformOneClick('outlook')" data-platform="outlook">
                    <span>‚ö°</span> One-Click Connect
                </button>
                <button class="btn btn-secondary" onclick="configurePlatform('outlook')">
                    <span>‚öôÔ∏è</span> Configure
                </button>
            </div>
        </div>

        <!-- Apple Calendar Card -->
        <div class="platform-card" id="apple-card">
            <div class="platform-header">
                <div class="platform-icon">
                    <span>A</span>
                </div>
                <div class="platform-info">
                    <h3>Apple Calendar</h3>
                    <p>iCloud Calendar & Events Sync</p>
                </div>
            </div>

            <div class="platform-stats">
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Events</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Calendars</div>
                </div>
                <div class="stat-item">
                    <div class="status-indicator status-disconnected">
                        <span class="status-dot"></span>
                        <span>Offline</span>
                    </div>
                </div>
            </div>

            <div class="platform-actions">
                <button class="btn btn-primary" onclick="connectPlatformOneClick('apple')" data-platform="apple">
                    <span>‚ö°</span> One-Click Connect
                </button>
                <button class="btn btn-secondary" onclick="configurePlatform('apple')">
                    <span>‚öôÔ∏è</span> Configure
                </button>
            </div>
        </div>

        <!-- GitHub Card -->
        <div class="platform-card" id="github-card">
            <div class="platform-header">
                <div class="platform-icon">
                    <span>GH</span>
                </div>
                <div class="platform-info">
                    <h3>GitHub</h3>
                    <p>Repository & Issue Tracking</p>
                </div>
            </div>

            <div class="platform-stats">
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Repos</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-label">Issues</div>
                </div>
                <div class="stat-item">
                    <div class="status-indicator status-disconnected">
                        <span class="status-dot"></span>
                        <span>Offline</span>
                    </div>
                </div>
            </div>

            <div class="platform-actions">
                <button class="btn btn-primary" onclick="connectPlatformOneClick('github')" data-platform="github">
                    <span>‚ö°</span> One-Click Connect
                </button>
                <button class="btn btn-secondary" onclick="configurePlatform('github')">
                    <span>‚öôÔ∏è</span> Configure
                </button>
            </div>
        </div>
    </div>

    <!-- üìã Enhanced Security Notice -->
    <div class="security-notice">
        <p><strong>Enterprise-Grade Security:</strong> All API keys are encrypted using AES-256 encryption and stored
            securely. Your data privacy and security are our highest priorities. We never store or access your personal
            data.</p>
    </div>
</div>

<script>
    // üéØ Simple Platform Connection Functions
    let connectionStates = {};
    
    function connectPlatformOneClick(platform) {
        console.log(`üöÄ Starting connection for ${platform}...`);
        
        const card = document.getElementById(`${platform}-card`);
        const connectBtn = card.querySelector('.btn-primary');
        const statusIndicator = card.querySelector('.status-indicator');
        const statusText = statusIndicator.querySelector('span:last-child');
        
        // Update UI to show connecting state
        const originalText = connectBtn.innerHTML;
        connectBtn.innerHTML = '<span>üîÑ</span> Connecting...';
        connectBtn.disabled = true;
        statusIndicator.className = 'status-indicator status-warning';
        statusText.textContent = 'Connecting';
        
        // Simulate API connection
        const connectionTime = Math.random() * 2000 + 1000; // 1-3 seconds
        
        setTimeout(() => {
            // Success state
            connectBtn.innerHTML = '<span>‚úÖ</span> Connected';
            connectBtn.className = 'btn btn-secondary';
            statusIndicator.className = 'status-indicator status-connected';
            statusText.textContent = 'Online';
            
            // Update stats with mock data
            updatePlatformStats(platform);
            
            // Store connection state
            connectionStates[platform] = true;
            
            // Reset button after delay
            setTimeout(() => {
                connectBtn.innerHTML = '<span>üîÑ</span> Reconnect';
                connectBtn.disabled = false;
            }, 3000);
            
        }, connectionTime);
    }
    
    function configurePlatform(platform) {
        console.log(`‚öôÔ∏è Configuring ${platform}...`);
        alert(`${platform} configuration will be available in the next update!`);
    }
    
    function updatePlatformStats(platform) {
        const card = document.getElementById(`${platform}-card`);
        const statValues = card.querySelectorAll('.stat-value');
        
        // Mock data for different platforms
        const mockData = {
            notion: ['12', '156'],
            google: ['24', '3'],
            slack: ['8', '1.2K'],
            outlook: ['45', '18'],
            apple: ['15', '2'],
            github: ['7', '23']
        };
        
        const data = mockData[platform] || ['‚Äî', '‚Äî'];
        if (statValues[0]) statValues[0].textContent = data[0];
        if (statValues[1]) statValues[1].textContent = data[1];
    }
    
    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize connection states
        const platforms = ['notion', 'google', 'slack', 'outlook', 'apple', 'github'];
        platforms.forEach(platform => {
            connectionStates[platform] = false;
        });
        
        console.log('‚úÖ API Keys page loaded successfully');
    });
    
    // Make functions globally available
    window.connectPlatformOneClick = connectPlatformOneClick;
    window.configurePlatform = configurePlatform;
</script>

{% endblock %}
