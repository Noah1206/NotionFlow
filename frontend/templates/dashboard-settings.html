{% extends "base_dashboard.html" %}

{% block title %}NotionFlow 설정 | 생산성 관리 센터{% endblock %}

{% block description %}NotionFlow 설정 페이지에서 생산성 지표를 확인하고 API 키를 관리하세요. 실시간 시간 절약 현황과 플랫폼 연결 상태를 관리하세요.{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/sidebar.css') }}?v={{ range(100000, 999999) | random }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/settings-redesign.css') }}?v={{ range(100000, 999999) | random }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<div class="settings-container">
    <!-- Header Section -->
    <div class="settings-header">
        <div class="header-content">
            <h1 class="page-title">설정</h1>
            <p class="page-subtitle">생산성 관리 및 시스템 설정을 확인하세요</p>
        </div>
        <div class="header-actions">
            <button class="btn-icon">
                <i class="fas fa-bell"></i>
            </button>
            <button class="btn-icon">
                <i class="fas fa-cog"></i>
            </button>
        </div>
    </div>

    <!-- Activity Report Section -->
    <section class="content-section">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-chart-line"></i>
                이번 주 활동 리포트
            </h2>
            <span class="section-badge">실시간</span>
        </div>
        
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="metric-content">
                    <div class="metric-value">
                        <span class="metric-number">24.5</span>
                        <span class="metric-unit">시간</span>
                    </div>
                    <div class="metric-label">총 절약 시간</div>
                    <div class="metric-change positive">
                        <i class="fas fa-arrow-up"></i>
                        12% 증가
                    </div>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="metric-content">
                    <div class="metric-value">
                        <span class="metric-number">98.2</span>
                        <span class="metric-unit">%</span>
                    </div>
                    <div class="metric-label">성공률</div>
                    <div class="metric-change positive">
                        <i class="fas fa-arrow-up"></i>
                        2.1% 개선
                    </div>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-icon">
                    <i class="fas fa-sync"></i>
                </div>
                <div class="metric-content">
                    <div class="metric-value">
                        <span class="metric-number">156</span>
                        <span class="metric-unit">회</span>
                    </div>
                    <div class="metric-label">동기화 횟수</div>
                    <div class="metric-change neutral">
                        <i class="fas fa-minus"></i>
                        변화 없음
                    </div>
                </div>
            </div>
        </div>

        <!-- Weekly Activity Chart -->
        <div class="chart-container">
            <canvas id="weeklyChart"></canvas>
        </div>
    </section>

    <!-- Automation Recommendations -->
    <section class="content-section">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-magic"></i>
                AI 자동화 추천
            </h2>
            <button class="btn-text">모두 보기</button>
        </div>
        
        <div class="recommendation-grid">
            <div class="recommendation-card">
                <div class="rec-icon">
                    <i class="fab fa-slack"></i>
                </div>
                <div class="rec-content">
                    <h3 class="rec-title">Slack 일일 요약 자동화</h3>
                    <p class="rec-description">매일 오후 6시에 Slack 메시지를 Notion에 자동 백업</p>
                    <div class="rec-footer">
                        <span class="rec-savings">주 2시간 절약 예상</span>
                        <button class="btn-primary-small">활성화</button>
                    </div>
                </div>
            </div>
            
            <div class="recommendation-card">
                <div class="rec-icon">
                    <i class="fas fa-calendar"></i>
                </div>
                <div class="rec-content">
                    <h3 class="rec-title">캘린더 일정 동기화</h3>
                    <p class="rec-description">Google Calendar와 Notion 데이터베이스 실시간 연동</p>
                    <div class="rec-footer">
                        <span class="rec-savings">주 3시간 절약 예상</span>
                        <button class="btn-primary-small">활성화</button>
                    </div>
                </div>
            </div>
            
            <div class="recommendation-card">
                <div class="rec-icon">
                    <i class="fas fa-envelope"></i>
                </div>
                <div class="rec-content">
                    <h3 class="rec-title">이메일 태스크 전환</h3>
                    <p class="rec-description">중요 이메일을 자동으로 Notion 태스크로 변환</p>
                    <div class="rec-footer">
                        <span class="rec-savings">주 1.5시간 절약 예상</span>
                        <button class="btn-primary-small">활성화</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Platform Status -->
    <section class="content-section">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-plug"></i>
                연결 상태 관리
            </h2>
            <button class="btn-text">연결 추가</button>
        </div>
        
        <div class="platform-grid">
            <div class="platform-card connected">
                <div class="platform-icon">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/4/45/Notion_app_logo.png" alt="Notion">
                </div>
                <div class="platform-info">
                    <h3 class="platform-name">Notion</h3>
                    <span class="platform-status">
                        <i class="fas fa-circle"></i>
                        연결됨
                    </span>
                </div>
                <button class="btn-secondary-small">관리</button>
            </div>
            
            <div class="platform-card connected">
                <div class="platform-icon">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/d/de/Microsoft_Outlook_2013_logo.svg" alt="Outlook">
                </div>
                <div class="platform-info">
                    <h3 class="platform-name">Outlook</h3>
                    <span class="platform-status">
                        <i class="fas fa-circle"></i>
                        연결됨
                    </span>
                </div>
                <button class="btn-secondary-small">관리</button>
            </div>
            
            <div class="platform-card disconnected">
                <div class="platform-icon">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b9/Slack_Technologies_Logo.svg" alt="Slack">
                </div>
                <div class="platform-info">
                    <h3 class="platform-name">Slack</h3>
                    <span class="platform-status disconnected">
                        <i class="fas fa-circle"></i>
                        연결 끊김
                    </span>
                </div>
                <button class="btn-warning-small">재연결</button>
            </div>
            
            <div class="platform-card add-new">
                <div class="platform-icon">
                    <i class="fas fa-plus"></i>
                </div>
                <div class="platform-info">
                    <h3 class="platform-name">새 플랫폼 추가</h3>
                    <span class="platform-status">더 많은 서비스 연결</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Recent Activity Log -->
    <section class="content-section">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-history"></i>
                최근 활동 로그
            </h2>
            <button class="btn-text">전체 기록</button>
        </div>
        
        <div class="activity-list">
            <div class="activity-item">
                <div class="activity-icon success">
                    <i class="fas fa-check"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">Notion 페이지 동기화 완료</div>
                    <div class="activity-meta">
                        <span class="activity-time">5분 전</span>
                        <span class="activity-platform">Notion</span>
                    </div>
                </div>
                <div class="activity-status success">성공</div>
            </div>
            
            <div class="activity-item">
                <div class="activity-icon success">
                    <i class="fas fa-check"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">캘린더 일정 업데이트</div>
                    <div class="activity-meta">
                        <span class="activity-time">1시간 전</span>
                        <span class="activity-platform">Google Calendar</span>
                    </div>
                </div>
                <div class="activity-status success">성공</div>
            </div>
            
            <div class="activity-item">
                <div class="activity-icon warning">
                    <i class="fas fa-exclamation"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">Slack 메시지 백업 일부 실패</div>
                    <div class="activity-meta">
                        <span class="activity-time">3시간 전</span>
                        <span class="activity-platform">Slack</span>
                    </div>
                </div>
                <div class="activity-status warning">부분 성공</div>
            </div>
            
            <div class="activity-item">
                <div class="activity-icon success">
                    <i class="fas fa-check"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">이메일 태스크 변환</div>
                    <div class="activity-meta">
                        <span class="activity-time">6시간 전</span>
                        <span class="activity-platform">Outlook</span>
                    </div>
                </div>
                <div class="activity-status success">성공</div>
            </div>
        </div>
    </section>

    <!-- Upcoming Schedule -->
    <section class="content-section">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-calendar-alt"></i>
                향후 일정 & 알림
            </h2>
            <button class="btn-text">일정 관리</button>
        </div>
        
        <div class="schedule-list">
            <div class="schedule-item">
                <div class="schedule-time">
                    <span class="time">14:00</span>
                    <span class="date">오늘</span>
                </div>
                <div class="schedule-content">
                    <h4 class="schedule-title">주간 리포트 생성</h4>
                    <p class="schedule-description">모든 플랫폼 데이터 종합 분석</p>
                </div>
                <div class="schedule-action">
                    <button class="btn-icon-small">
                        <i class="fas fa-ellipsis-h"></i>
                    </button>
                </div>
            </div>
            
            <div class="schedule-item">
                <div class="schedule-time">
                    <span class="time">09:00</span>
                    <span class="date">내일</span>
                </div>
                <div class="schedule-content">
                    <h4 class="schedule-title">정기 백업</h4>
                    <p class="schedule-description">Notion 워크스페이스 전체 백업</p>
                </div>
                <div class="schedule-action">
                    <button class="btn-icon-small">
                        <i class="fas fa-ellipsis-h"></i>
                    </button>
                </div>
            </div>
            
            <div class="schedule-item">
                <div class="schedule-time">
                    <span class="time">18:00</span>
                    <span class="date">금요일</span>
                </div>
                <div class="schedule-content">
                    <h4 class="schedule-title">주간 대시보드 업데이트</h4>
                    <p class="schedule-description">생산성 지표 및 인사이트 업데이트</p>
                </div>
                <div class="schedule-action">
                    <button class="btn-icon-small">
                        <i class="fas fa-ellipsis-h"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Updates & Announcements -->
    <section class="content-section">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-bullhorn"></i>
                업데이트 & 공지
            </h2>
            <button class="btn-text">모든 업데이트</button>
        </div>
        
        <div class="announcement-list">
            <div class="announcement-card new">
                <div class="announcement-badge">NEW</div>
                <div class="announcement-content">
                    <h3 class="announcement-title">ClickUp 통합 기능 출시</h3>
                    <p class="announcement-description">이제 ClickUp 프로젝트도 NotionFlow에서 관리할 수 있습니다.</p>
                    <div class="announcement-meta">
                        <span class="announcement-date">2024년 1월 10일</span>
                        <a href="#" class="announcement-link">자세히 보기 →</a>
                    </div>
                </div>
            </div>
            
            <div class="announcement-card">
                <div class="announcement-content">
                    <h3 class="announcement-title">성능 개선 업데이트</h3>
                    <p class="announcement-description">동기화 속도가 30% 향상되었습니다.</p>
                    <div class="announcement-meta">
                        <span class="announcement-date">2024년 1월 8일</span>
                        <a href="#" class="announcement-link">자세히 보기 →</a>
                    </div>
                </div>
            </div>
            
            <div class="announcement-card">
                <div class="announcement-content">
                    <h3 class="announcement-title">정기 점검 안내</h3>
                    <p class="announcement-description">1월 15일 새벽 2시부터 4시까지 서비스 점검이 예정되어 있습니다.</p>
                    <div class="announcement-meta">
                        <span class="announcement-date">2024년 1월 5일</span>
                        <a href="#" class="announcement-link">자세히 보기 →</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Settings Actions -->
    <section class="content-section">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-cog"></i>
                빠른 설정
            </h2>
        </div>
        
        <div class="settings-grid">
            <div class="setting-card">
                <div class="setting-header">
                    <h3 class="setting-title">알림 설정</h3>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <p class="setting-description">동기화 완료 및 오류 알림을 받습니다</p>
            </div>
            
            <div class="setting-card">
                <div class="setting-header">
                    <h3 class="setting-title">자동 동기화</h3>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <p class="setting-description">30분마다 자동으로 데이터를 동기화합니다</p>
            </div>
            
            <div class="setting-card">
                <div class="setting-header">
                    <h3 class="setting-title">이메일 알림</h3>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <p class="setting-description">중요한 업데이트를 이메일로 받습니다</p>
            </div>
            
            <div class="setting-card">
                <div class="setting-header">
                    <h3 class="setting-title">데이터 백업</h3>
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <p class="setting-description">주간 자동 백업을 활성화합니다</p>
            </div>
        </div>
    </section>
</div>

<script>
// Chart.js Configuration
const ctx = document.getElementById('weeklyChart').getContext('2d');
const weeklyChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: ['월', '화', '수', '목', '금', '토', '일'],
        datasets: [{
            label: '절약 시간 (시간)',
            data: [3.2, 4.1, 3.8, 5.2, 4.5, 2.8, 3.5],
            borderColor: '#3B82F6',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            borderWidth: 2,
            tension: 0.4,
            pointBackgroundColor: '#3B82F6',
            pointBorderColor: '#fff',
            pointBorderWidth: 2,
            pointRadius: 4,
            pointHoverRadius: 6
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                display: false
            },
            tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                padding: 12,
                cornerRadius: 8,
                titleFont: {
                    size: 14
                },
                bodyFont: {
                    size: 13
                }
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                grid: {
                    color: 'rgba(0, 0, 0, 0.05)',
                    drawBorder: false
                },
                ticks: {
                    padding: 10,
                    color: '#6B7280',
                    font: {
                        size: 12
                    }
                }
            },
            x: {
                grid: {
                    display: false,
                    drawBorder: false
                },
                ticks: {
                    padding: 10,
                    color: '#6B7280',
                    font: {
                        size: 12
                    }
                }
            }
        }
    }
});

// Initialize light theme
document.documentElement.setAttribute('data-theme', 'light');
</script>
{% endblock %}