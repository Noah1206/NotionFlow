<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ formatted_date }} - {{ calendar.name }} - NotionFlow</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='images/favicon.svg') }}">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="{{ url_for('static', filename='images/favicon-16x16.svg') }}">
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="{{ url_for('static', filename='images/favicon-32x32.svg') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='images/apple-touch-icon.svg') }}">
    <link rel="icon" type="image/svg+xml" sizes="192x192" href="{{ url_for('static', filename='images/icon-192x192.svg') }}">
    <link rel="icon" type="image/svg+xml" sizes="512x512" href="{{ url_for('static', filename='images/icon-512x512.svg') }}">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <meta name="theme-color" content="#3B82F6">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/variables.css') }}?v={{ range(100000, 999999) | random }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/calendar-day.css') }}?v={{ range(100000, 999999) | random }}">
    
    <!-- Core notification system -->
    <script src="{{ url_for('static', filename='js/notification-utils.js') }}?v={{ range(100000, 999999) | random }}"></script>
</head>

<body class="calendar-day-page">

<div class="calendar-day-workspace" data-calendar-id="{{ calendar.id }}" data-selected-date="{{ selected_date }}">
    
    <!-- Top Navigation Bar -->
    <div class="calendar-topbar">
        <div class="topbar-left">
            <button class="btn-back" onclick="window.location.href='/dashboard/calendar/{{ calendar.id }}'">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
            </button>
            <div class="calendar-header-info">
                <div class="calendar-icon-small" style="background: {{ calendar.color or '#3B82F6' }}"></div>
                <div class="header-text">
                    <h1 class="calendar-name">{{ calendar.name }}</h1>
                    <div class="date-info">
                        <span class="formatted-date">{{ formatted_date }}</span>
                        <span class="weekday">{{ weekday }}</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="topbar-right">
            <button class="btn-add-event" onclick="openEventModal()">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <line x1="12" y1="5" x2="12" y2="19"/>
                    <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
                새 이벤트
            </button>
            
            <button class="btn-today" onclick="goToToday()">오늘</button>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="calendar-day-content">
        <!-- Daily Routine Section -->
        <div class="daily-routine-section excel-widget">
            <div class="widget-header">
                <div class="widget-icon">🔄</div>
                <h3>Daily Routine</h3>
                <button class="add-btn" onclick="addRoutineItem()" title="루틴 추가">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
            </div>
            
            <!-- Excel-style grid table -->
            <div class="excel-table routine-table">
                <div class="table-header">
                    <div class="header-cell time-column">시간</div>
                    <div class="header-cell activity-column">활동</div>
                    <div class="header-cell status-column">완료</div>
                </div>
                <div class="table-body">
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">06:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Morning Meditation</div>
                            <div class="activity-description">10분 명상으로 마음 정리</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">06:30</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Stretching & Water</div>
                            <div class="activity-description">전신 스트레칭 + 물 500ml</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">07:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Morning Workout</div>
                            <div class="activity-description">홈트레이닝 45분 (근력/유산소)</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">08:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Healthy Breakfast</div>
                            <div class="activity-description">단백질 + 탄수화물 균형잡힌 아침식사</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">09:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Deep Work Session #1</div>
                            <div class="activity-description">가장 중요한 업무 2시간 집중</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">11:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Coffee Break & Review</div>
                            <div class="activity-description">커피 + 오전 업무 정리</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">11:30</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Communication Time</div>
                            <div class="activity-description">이메일/메신저 확인 및 답변</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">12:30</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Mindful Lunch</div>
                            <div class="activity-description">천천히 음미하며 점심 식사</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">14:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Deep Work Session #2</div>
                            <div class="activity-description">창의적 작업 및 문제 해결</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">16:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Learning Time</div>
                            <div class="activity-description">새로운 스킬/지식 학습 1시간</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">17:30</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Daily Review</div>
                            <div class="activity-description">오늘 성과 리뷰 + 내일 계획</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">19:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Personal Time</div>
                            <div class="activity-description">취미활동/휴식/가족시간</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">21:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Evening Reading</div>
                            <div class="activity-description">책 읽기 또는 업계 아티클</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">22:00</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Digital Detox</div>
                            <div class="activity-description">모든 디지털 기기 OFF</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                    <div class="table-row routine-row" draggable="true">
                        <div class="cell time-cell">22:30</div>
                        <div class="cell activity-cell">
                            <div class="activity-title">Night Routine</div>
                            <div class="activity-description">세면 + 내일 옷 준비 + 감사일기</div>
                        </div>
                        <div class="cell status-cell">
                            <input type="checkbox" class="routine-checkbox">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Events Section -->
        <div class="events-section excel-widget">
            <div class="widget-header">
                <div class="widget-icon">📅</div>
                <h3>Events</h3>
                <button class="add-btn" onclick="openEventModal()" title="이벤트 추가">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
            </div>
            
            <div class="events-content" id="day-events">
                <!-- Events table with sample data -->
                <div class="excel-table events-table">
                    <div class="table-header">
                        <div class="header-cell time-column">시간</div>
                        <div class="header-cell event-column">제목</div>
                        <div class="header-cell tag-column">태그</div>
                    </div>
                    <div class="table-body" id="events-table-body">
                        <div class="table-row event-row">
                            <div class="cell time-cell">10:00</div>
                            <div class="cell event-cell">
                                <div class="event-title">🏢 스프린트 계획 미팅</div>
                                <div class="event-description">다음 주 개발 일정 논의 및 우선순위 설정</div>
                            </div>
                            <div class="cell tag-cell">
                                <span class="event-tag work">업무</span>
                            </div>
                        </div>
                        <div class="table-row event-row">
                            <div class="cell time-cell">15:30</div>
                            <div class="cell event-cell">
                                <div class="event-title">☕ 1:1 코치 세션</div>
                                <div class="event-description">개발 커리어 성장 상담 및 피드백</div>
                            </div>
                            <div class="cell tag-cell">
                                <span class="event-tag personal">개인</span>
                            </div>
                        </div>
                        <div class="table-row event-row">
                            <div class="cell time-cell">18:00</div>
                            <div class="cell event-cell">
                                <div class="event-title">🎓 온라인 세미나</div>
                                <div class="event-description">"React 18의 새로운 기능과 성능 최적화"</div>
                            </div>
                            <div class="cell tag-cell">
                                <span class="event-tag learning">학습</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Add event button -->
                <div class="add-event-section">
                    <button class="btn-primary" onclick="openEventModal()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <line x1="12" y1="5" x2="12" y2="19"/>
                            <line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                        새 이벤트 추가
                    </button>
                </div>
            </div>
        </div>

        <!-- Tasks Section -->
        <div class="tasks-section excel-widget">
            <div class="widget-header">
                <div class="widget-icon">✅</div>
                <h3>Tasks</h3>
                <button class="add-btn" onclick="addTaskItem()" title="할 일 추가">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
            </div>
            
            <div class="excel-table tasks-table">
                <div class="table-header">
                    <div class="header-cell status-column">완료</div>
                    <div class="header-cell task-column">작업</div>
                    <div class="header-cell priority-column">우선순위</div>
                </div>
                <div class="table-body">
                    <div class="table-row task-row" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox">
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">🚀 Render 배포 최적화</div>
                            <div class="task-description">환경변수 설정 + 빌드 스크립트 점검</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip high">중요</span>
                        </div>
                    </div>
                    <div class="table-row task-row" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox">
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">📊 대시보드 성능 모니터링</div>
                            <div class="task-description">로딩 속도 개선 + 메모리 사용량 최적화</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip high">중요</span>
                        </div>
                    </div>
                    <div class="table-row task-row" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox">
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">💡 사용자 피드백 분석</div>
                            <div class="task-description">UI/UX 개선점 찾기 + 우선순위 정리</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip medium">보통</span>
                        </div>
                    </div>
                    <div class="table-row task-row" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox">
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">🔐 보안 업데이트</div>
                            <div class="task-description">라이브러리 의존성 점검 + 취약점 패치</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip high">중요</span>
                        </div>
                    </div>
                    <div class="table-row task-row" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox">
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">📱 모바일 반응형 테스트</div>
                            <div class="task-description">iPhone/Android 다양한 해상도 검증</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip medium">보통</span>
                        </div>
                    </div>
                    <div class="table-row task-row" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox">
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">🎨 디자인 시스템 정리</div>
                            <div class="task-description">컴포넌트 라이브러리 + 스타일 가이드 작성</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip low">낮음</span>
                        </div>
                    </div>
                    <div class="table-row task-row" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox">
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">🐛 버그 리포트 처리</div>
                            <div class="task-description">GitHub Issues #12, #15, #18 해결</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip medium">보통</span>
                        </div>
                    </div>
                    <div class="table-row task-row" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox">
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">📚 기술 문서 업데이트</div>
                            <div class="task-description">API 문서 + 사용자 가이드 최신화</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip low">낮음</span>
                        </div>
                    </div>
                    <div class="table-row task-row completed" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox" checked>
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">✨ 캘린더 UI 개선</div>
                            <div class="task-description">Excel 스타일 + 인라인 편집 기능 완성</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip high">중요</span>
                        </div>
                    </div>
                    <div class="table-row task-row completed" draggable="true">
                        <div class="cell status-cell">
                            <input type="checkbox" class="task-checkbox" checked>
                        </div>
                        <div class="cell task-cell">
                            <div class="task-title">🔍 이벤트 검색 기능</div>
                            <div class="task-description">실시간 필터링 + 결과 하이라이팅 구현</div>
                        </div>
                        <div class="cell priority-cell">
                            <span class="priority-chip medium">보통</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="notes-section excel-widget">
            <div class="widget-header">
                <div class="widget-icon">📝</div>
                <h3>Notes</h3>
                <button class="save-notes-btn" onclick="saveNotes()">저장</button>
            </div>
            
            <div class="notes-container">
                <div class="notes-header">
                    <input type="text" class="notes-title" placeholder="메모 제목..." value="📝 오늘의 개발 회고 & 내일 계획">
                </div>
                <div class="notes-body">
                    <textarea class="notes-textarea" placeholder="메모 내용을 작성하세요..." rows="8">✨ 오늘 완성한 것들:
• Excel 스타일 캘린더 Day 페이지 완성
• 인라인 텍스트 편집 기능 구현 (더블클릭 → 편집)
• 드래그 앤 드롭으로 순서 변경 가능
• 완료 체크박스 시각 효과 개선
• 15개의 체계적인 Daily Routine 작성

🚀 Render 배포 관련 고려사항:
• 환경변수 설정 체크 필요
• 빌드 최적화로 로딩 속도 개선
• PostgreSQL 연결 안정성 확인
• HTTPS 리디렉션 설정

💡 내일 우선순위:
1. 모바일 반응형 최종 점검
2. 성능 모니터링 도구 연결
3. 사용자 피드백 수집 시스템
4. 보안 취약점 점검

🎯 주요 메트릭스:
• 페이지 로딩 속도: < 2초 목표
• 모바일 친화성: 95% 이상
• 접근성 점수: AA 등급 달성</textarea>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Event Creation Modal -->
<div class="modal-overlay" id="event-modal" style="display: none;">
    <div class="modal-content event-modal">
        <div class="modal-header">
            <h2 class="modal-title">새 이벤트</h2>
            <button class="modal-close" onclick="closeEventModal()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>
        
        <div class="modal-body">
            <div class="form-group">
                <label>제목</label>
                <input type="text" id="event-title" placeholder="이벤트 제목 입력">
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>시작일</label>
                    <input type="datetime-local" id="event-start">
                </div>
                <div class="form-group">
                    <label>종료일</label>
                    <input type="datetime-local" id="event-end">
                </div>
            </div>
            
            <div class="form-group">
                <label>설명</label>
                <textarea id="event-description" rows="4" placeholder="이벤트 설명 (선택사항)"></textarea>
            </div>
            
            <div class="form-group">
                <label>색상</label>
                <div class="color-picker">
                    <button class="color-option active" data-color="#3B82F6" style="background: #3B82F6"></button>
                    <button class="color-option" data-color="#10B981" style="background: #10B981"></button>
                    <button class="color-option" data-color="#F59E0B" style="background: #F59E0B"></button>
                    <button class="color-option" data-color="#EF4444" style="background: #EF4444"></button>
                    <button class="color-option" data-color="#8B5CF6" style="background: #8B5CF6"></button>
                    <button class="color-option" data-color="#EC4899" style="background: #EC4899"></button>
                </div>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="event-allday">
                    <span>종일 이벤트</span>
                </label>
            </div>
            
            <div class="form-actions">
                <button class="btn-cancel" onclick="closeEventModal()">취소</button>
                <button class="btn-save" onclick="saveEvent()">저장</button>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript -->
<script src="{{ url_for('static', filename='js/calendar-day.js') }}?v={{ range(100000, 999999) | random }}"></script>

</body>
</html>