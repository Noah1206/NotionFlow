<!-- 
    âœ…âœ…âœ… NOTIONFLOW SIDEBAR v5.0 - FIXED VERSION âœ…âœ…âœ…
    =============================================
    CACHE BUSTER: {{ range(500000, 999999) | random }}
    DEPLOYED: 2025-08-07 01:20 KST - CALENDAR LIST MODE
    STATUS: showCalendarList() FUNCTION READY
    VERSION: 5.0 - DIRECT CALENDAR LIST UI
    =============================================
-->

<!-- ì ‘íŒ ìƒíƒœ ì „ìš© í–„ë²„ê±° ë²„íŠ¼ -->
<div class="collapsed-header">
    <button class="collapsed-toggle-btn" onclick="toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </button>
</div>

<!-- í¼ì³ì§„ ìƒíƒœ ì „ìš© í—¤ë” - ë¡œê³ ì™€ í† ê¸€ ë²„íŠ¼ -->
<div class="expanded-header">
    <div class="sidebar-logo">
        <span class="logo-text">NodeFlow</span>
    </div>
    <button class="expanded-toggle-btn" onclick="toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
    </button>
</div>

<!-- ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ -->
<nav class="sidebar-nav">
    <!-- ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜ wrapper - ìŠ¤í¬ë¡¤ ê°€ëŠ¥ -->
    <div class="sidebar-main-nav">
        <!-- í”„ë¡œí•„ ì„¹ì…˜ - ìµœìƒë‹¨ ìš°ì„ ìˆœìœ„ -->
        <div class="nav-section">
            <!-- í”„ë¡œí•„ -->
            <div class="nav-item profile-nav-item {{ 'active' if current_page == 'profile' else '' }}"
                data-section="profile" onclick="handleSidebarItemClick('profile')">
                <span class="nav-icon profile-avatar-icon">
                    <img id="sidebar-profile-avatar" src="" alt="í”„ë¡œí•„"
                        class="sidebar-avatar">
                </span>
                <span class="nav-label">í”„ë¡œí•„</span>
            </div>
        </div>

        <!-- ìº˜ë¦°ë” ì„¹ì…˜ -->
        <div class="nav-section">
            <div class="nav-item {{ 'active' if current_page == 'calendar-list' else '' }}" data-section="calendar-list"
                onclick="handleSidebarItemClick('calendar-list')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                        <line x1="16" y1="2" x2="16" y2="6" />
                        <line x1="8" y1="2" x2="8" y2="6" />
                        <line x1="3" y1="10" x2="21" y2="10" />
                    </svg>
                </span>
                <span class="nav-label">ìº˜ë¦°ë” ëª©ë¡</span>
            </div>
        </div>

        <!-- Reminders Section (Calendar Detail Page Only) -->
        <div class="nav-section reminders-section calendar-detail-only">
            <div class="reminders-header">
                <span class="reminders-icon">ğŸ“</span>
                <span class="reminders-title">Reminders</span>
            </div>
            <div class="reminders-content">
                <div class="reminder-item">
                    <span class="reminder-text">ë¦¬ë§ˆì¸ë”ê°€ ì—†ìŠµë‹ˆë‹¤</span>
                </div>
            </div>
        </div>

        <!-- Media Player Widget (Calendar Detail Page Only) -->
        <div class="nav-section media-player-section calendar-detail-only">
            <div class="media-player-widget">
                <div class="media-player-header">
                    <span class="media-player-icon">ğŸµ</span>
                    <span class="media-player-title">ë¯¸ë””ì–´ í”Œë ˆì´ì–´</span>
                </div>
                <div class="media-player-content">
                    <div class="media-info">
                        <div class="media-title" id="sidebar-media-title">ë¯¸ë””ì–´ ì—†ìŒ</div>
                        <div class="media-artist" id="sidebar-media-artist">ìº˜ë¦°ë”</div>
                    </div>
                    <div class="media-controls">
                        <button class="media-btn" id="sidebar-prev-btn" onclick="sidebarPrevTrack()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="19,20 9,12 19,4"></polygon>
                                <line x1="5" y1="19" x2="5" y2="5"></line>
                            </svg>
                        </button>
                        <button class="media-btn media-btn-play" id="sidebar-play-btn" onclick="sidebarTogglePlay()">
                            <svg class="play-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="5,3 19,12 5,21"></polygon>
                            </svg>
                            <svg class="pause-icon" style="display: none;" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="6" y="4" width="4" height="16"></rect>
                                <rect x="14" y="4" width="4" height="16"></rect>
                            </svg>
                        </button>
                        <button class="media-btn" id="sidebar-next-btn" onclick="sidebarNextTrack()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="5,4 15,12 5,20"></polygon>
                                <line x1="19" y1="5" x2="19" y2="19"></line>
                            </svg>
                        </button>
                    </div>
                    <div class="media-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="sidebar-progress-fill"></div>
                        </div>
                        <div class="time-info">
                            <span id="sidebar-current-time">0:00</span>
                            <span id="sidebar-total-time">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mini Calendar Widget (Calendar Detail Page Only) -->
        <div class="nav-section mini-calendar-section calendar-detail-only">
            <div class="mini-calendar-widget">
                <div class="calendar-view-container active" id="month-view">
                    <div class="compact-month-header">
                        <div class="compact-weekday-labels">
                            <div class="compact-weekday-label">ì¼</div>
                            <div class="compact-weekday-label">ì›”</div>
                            <div class="compact-weekday-label">í™”</div>
                            <div class="compact-weekday-label">ìˆ˜</div>
                            <div class="compact-weekday-label">ëª©</div>
                            <div class="compact-weekday-label">ê¸ˆ</div>
                            <div class="compact-weekday-label">í† </div>
                        </div>
                    </div>
                    
                    <div class="compact-month-grid" id="month-grid">
                        <!-- Calendar cells will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ë‹¬ë ¥ í˜ì´ì§€ ì„¹ì…˜ -->
        <div class="nav-section">
            <div class="nav-item {{ 'active' if current_page == 'calendar' else '' }}" data-section="calendar"
                onclick="handleSidebarItemClick('calendar')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                        <line x1="16" y1="2" x2="16" y2="6" />
                        <line x1="8" y1="2" x2="8" y2="6" />
                        <line x1="3" y1="10" x2="21" y2="10" />
                        <rect x="7" y="14" width="3" height="3" />
                    </svg>
                </span>
                <span class="nav-label">ë‹¬ë ¥</span>
            </div>
        </div>

        <!-- ì—°ê²° & ê´€ë¦¬ ì„¹ì…˜ -->
        <div class="nav-section">

            <div class="nav-item {{ 'active' if current_page == 'friends' else '' }}" data-section="friends"
                onclick="handleSidebarItemClick('friends')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                        <circle cx="9" cy="7" r="4" />
                        <path d="m22 21-3-3m0 0a5 5 0 1 0-7 0l3 3" />
                    </svg>
                </span>
                <span class="nav-label">ì¹œêµ¬</span>
                <span class="count-badge">0</span>
            </div>

            <div class="nav-item {{ 'active' if current_page == 'api-keys' else '' }}" data-section="api-keys"
                onclick="handleSidebarItemClick('api-keys')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="7.5" cy="15.5" r="5.5" />
                        <path d="m21 2-9.6 9.6" />
                        <path d="m15.5 7.5 3 3L22 7l-3-3" />
                    </svg>
                </span>
                <span class="nav-label">API í‚¤ ê´€ë¦¬</span>
            </div>

            <!-- ì„¤ì • ì•„ì´ì½˜ì„ ì—°ê²° & ê´€ë¦¬ ì„¹ì…˜ìœ¼ë¡œ ì´ë™ -->
            <div class="nav-item {{ 'active' if current_page == 'settings' else '' }}"
                onclick="handleSidebarItemClick('settings')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </span>
                <span class="nav-label">ì„¤ì •</span>
            </div>

        </div>
    </div>
    <!-- ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜ wrapper ë -->

    <!-- í•˜ë‹¨ ê³ ì • ì„¹ì…˜ ì œê±° - ì„¤ì • ì•„ì´ì½˜ì´ ì—°ê²° & ê´€ë¦¬ ì„¹ì…˜ìœ¼ë¡œ ì´ë™ë¨ -->
</nav>
</div>


<!-- ì„¤ì • ëª¨ë‹¬ -->
<div id="settings-modal" class="calendar-modal-overlay" style="display: none;">
    <div class="calendar-modal-content settings-modal-content">
        <div class="calendar-modal-header">
            <h2 class="calendar-modal-title">ì„¤ì •</h2>
            <button class="calendar-modal-close" onclick="closeSettingsModal()">Ã—</button>
        </div>

        <div class="calendar-modal-body">
            <!-- ì–¸ì–´ ì„¤ì • -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">ì–¸ì–´</h3>
                    <p class="settings-section-desc">í‘œì‹œ ì–¸ì–´ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                </div>
                <div class="language-toggle">
                    <button class="language-toggle-btn" id="settingsLanguageToggle" onclick="toggleLanguageDropdown()">
                        <span class="lang-flag">ğŸ‡°ğŸ‡·</span>
                        <span class="lang-text">í•œêµ­ì–´</span>
                        <span class="toggle-arrow">âŒ„</span>
                    </button>
                    <div class="language-dropdown" id="settingsLanguageDropdown" style="display: none;">
                        <div class="language-option" onclick="setLanguage('ko')">
                            <span class="lang-flag">ğŸ‡°ğŸ‡·</span>
                            <span class="lang-name">í•œêµ­ì–´</span>
                        </div>
                        <div class="language-option" onclick="setLanguage('en')">
                            <span class="lang-flag">ğŸ‡ºğŸ‡¸</span>
                            <span class="lang-name">English</span>
                        </div>
                    </div>
                </div>
            </div>


            <!-- í”Œë«í¼ ìƒíƒœ -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">í”Œë«í¼ ìƒíƒœ</h3>
                    <p class="settings-section-desc">ì—°ê²°ëœ í”Œë«í¼ê³¼ ë™ê¸°í™” í˜„í™©</p>
                </div>
                <div class="platform-stats-grid">
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">1,247</div>
                        <div class="platform-stat-label">ë™ê¸°í™”ëœ ì´ë²¤íŠ¸</div>
                        <div class="platform-stat-desc">ì´ë²ˆ ë‹¬ ëª¨ë“  í”Œë«í¼ì—ì„œ ë™ê¸°í™”ëœ ì´ ì´ë²¤íŠ¸ ìˆ˜</div>
                    </div>
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">60%</div>
                        <div class="platform-stat-label">í”Œë«í¼ ì»¤ë²„ë¦¬ì§€</div>
                        <div class="platform-stat-desc">ì—°ê²°ëœ í”Œë«í¼: Notion, Google Calendar, Apple Calendar</div>
                    </div>
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">24.5h</div>
                        <div class="platform-stat-label">ì ˆì•½ëœ ì‹œê°„</div>
                        <div class="platform-stat-desc">ì´ë²ˆ ì£¼ ìë™í™”ë¥¼ í†µí•´ ì ˆì•½ëœ ì˜ˆìƒ ì‹œê°„</div>
                    </div>
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">92%</div>
                        <div class="platform-stat-label">ë™ê¸°í™” ì„±ê³µë¥ </div>
                        <div class="platform-stat-desc">ì§€ë‚œ 30ì¼ê°„ ì„±ê³µì ì¸ ë™ê¸°í™” ë¹„ìœ¨</div>
                    </div>
                </div>
            </div>

            <!-- í”Œë«í¼ ì—°ê²° ê´€ë¦¬ -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">í”Œë«í¼ ì—°ê²° ê´€ë¦¬</h3>
                    <p class="settings-section-desc">ê° í”Œë«í¼ì˜ API í‚¤ë¥¼ ê´€ë¦¬í•˜ê³  ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
                </div>
                <div class="platform-connections">
                    <!-- Notion -->
                    <div class="platform-connection-item">
                        <div class="platform-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M4.459 4.208c.746.606 1.026.56 2.428.466l13.215-.793c.28 0 .047-.28-.046-.326L17.86 1.968c-.42-.326-.981-.7-2.055-.607L3.01 2.295c-.466.046-.56.28-.374.466zm.793 3.08v13.904c0 .747.373 1.027 1.214.98l14.523-.84c.841-.046 1.121-.56 1.121-1.167V6.354c0-.606-.233-.933-.747-.887l-15.177.887c-.56.047-.934.373-.934 1.027zm13.748.327c.093.42 0 .84-.42.888l-.7.14v10.264c-.608.327-1.168.514-1.635.514-.748 0-.935-.234-1.495-.933l-4.577-7.186v6.952L12.21 19s0 .84-1.168.84l-3.222.186c-.093-.186 0-.653.327-.746l.84-.233V9.854L7.822 9.76c-.094-.42.14-1.026.793-1.073l3.456-.233 4.764 7.279v-6.44l-1.215-.139c-.093-.514.28-.887.747-.933zM1.936 1.035l13.31-.98c1.634-.14 2.055-.047 3.082.7l4.249 2.986c.7.513.934.653.934 1.213v16.378c0 1.026-.373 1.634-1.68 1.726l-15.458.934c-.98.047-1.448-.093-1.962-.747l-3.129-4.06c-.56-.747-.793-1.306-.793-1.96V2.667c0-.839.374-1.54 1.447-1.632z" />
                            </svg>
                        </div>
                        <div class="platform-info">
                            <h4>Notion</h4>
                            <p class="platform-status">ì—°ê²°ë˜ì§€ ì•ŠìŒ</p>
                        </div>
                        <button class="platform-connect-btn" onclick="connectPlatform('notion')">ì—°ê²°</button>
                    </div>
                    <!-- Google Calendar -->
                    <div class="platform-connection-item">
                        <div class="platform-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z" />
                            </svg>
                        </div>
                        <div class="platform-info">
                            <h4>Google Calendar</h4>
                            <p class="platform-status connected">ì—°ê²°ë¨</p>
                        </div>
                        <button class="platform-connect-btn connected" onclick="disconnectPlatform('google')">ì—°ê²°
                            í•´ì œ</button>
                    </div>
                    <!-- ì¶”ê°€ í”Œë«í¼ë“¤... -->
                </div>
            </div>

            <!-- ë¹ ë¥¸ ì•¡ì…˜ -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">ë¹ ë¥¸ ì•¡ì…˜</h3>
                </div>
                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="navigateToApiKeys()">
                        <span class="quick-action-icon">ğŸ”‘</span>
                        <span class="quick-action-text">API í‚¤ ê´€ë¦¬</span>
                    </button>
                    <button class="quick-action-btn" onclick="logoutUser()">
                        <span class="quick-action-icon">ğŸšª</span>
                        <span class="quick-action-text">ë¡œê·¸ì•„ì›ƒ</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="calendar-modal-footer">
            <button class="calendar-btn-cancel" onclick="closeSettingsModal()">ë‹«ê¸°</button>
        </div>
    </div>
    <style>
        /* ìº˜ë¦°ë” ê´€ë ¨ ìŠ¤íƒ€ì¼ ì‚­ì œë¨ */
        .removed-calendar-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
            visibility: visible;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .calendar-creation-modal.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .modal-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            animation: fadeIn 0.2s ease-out;
        }

        .calendar-modal-container {
            position: relative;
            z-index: 10001;
            animation: slideInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .calendar-modal-content {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
            width: 440px;
            max-width: 90vw;
            max-height: 85vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .calendar-creation-modal.hidden .calendar-modal-content {
            transform: translateY(20px) scale(0.95);
        }

        /* ëª¨ë‹¬ í—¤ë” */
        .calendar-modal-header {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
            position: relative;
            background: #fafafa;
        }

        .header-icon {
            display: none;
            /* ì•„ì´ì½˜ ì œê±°í•˜ì—¬ ë” ê¹”ë”í•˜ê²Œ */
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #111827;
            margin: 0;
            text-align: center;
        }

        .close-button {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            border-radius: 6px;
            color: #6b7280;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        .close-button:hover {
            background: #f3f4f6;
            color: #111827;
        }

        /* ëª¨ë‹¬ ë°”ë”” */
        .calendar-modal-body {
            padding: 24px;
            overflow-y: auto;
            flex: 1;
        }

        /* ë™ì  í¼ ìŠ¤íƒ€ì¼ */
        .calendar-form {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 4px;
        }

        .form-label svg {
            opacity: 0.7;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            color: #374151;
            background: #ffffff;
            transition: all 0.2s ease;
            box-sizing: border-box;
        }

        .form-input:focus {
            outline: none;
            border-color: #4285f4;
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }

        .form-helper {
            font-size: 12px;
            color: #6b7280;
            font-style: italic;
        }

        /* ë¼ë””ì˜¤ ê·¸ë£¹ ìŠ¤íƒ€ì¼ */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #ffffff;
        }

        .radio-option:hover {
            border-color: #d1d5db;
            background: #f9fafb;
        }

        .radio-option input[type="radio"] {
            display: none;
        }

        .radio-custom {
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            position: relative;
            transition: all 0.2s ease;
        }

        .radio-option input[type="radio"]:checked+.radio-custom {
            border-color: #4285f4;
            background: #4285f4;
        }

        .radio-option input[type="radio"]:checked+.radio-custom::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .radio-content {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .radio-title {
            font-size: 13px !important;
            font-weight: 600;
            color: #374151;
        }

        .radio-desc {
            font-size: 11px !important;
            color: #6b7280;
        }

        /* ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ìŠ¤íƒ€ì¼ */
        .color-palette {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 12px;
        }

        .color-palette input[type="radio"] {
            display: none;
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.1);
        }

        .color-option:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .color-palette input[type="radio"]:checked+.color-option {
            border-color: #111827;
            transform: scale(1.1);
            box-shadow: 0 0 0 2px #111827;
        }

        .color-palette input[type="radio"]:checked+.color-option::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 16px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 32px;
        }

        .btn-secondary,
        .btn-primary {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 100px;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .btn-primary {
            background: #2563eb;
            color: white;
            position: relative;
        }

        .btn-primary:hover {
            background: #3367d6;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
        }

        .btn-primary:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-loading {
            display: none;
        }

        .btn-primary.loading .btn-text {
            display: none;
        }

        .btn-primary.loading .btn-loading {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .loading-spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        /* ì• ë‹ˆë©”ì´ì…˜ í‚¤í”„ë ˆì„ */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        @keyframes dots {

            0%,
            20% {
                content: '.';
            }

            40% {
                content: '..';
            }

            60%,
            100% {
                content: '...';
            }
        }

        /* ë‹¤í¬ ëª¨ë“œ ì§€ì› */
        [data-theme="dark"] .calendar-modal-content {
            background: #1f2937;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        [data-theme="dark"] .modal-title {
            color: #f8fafc;
        }

        [data-theme="dark"] .modal-description {
            color: #94a3b8;
        }

        [data-theme="dark"] .calendar-option {
            background: #334155;
            border-color: #475569;
        }

        [data-theme="dark"] .calendar-option:hover {
            border-color: #64748b;
            background: #3f4f5f;
        }

        [data-theme="dark"] .option-title {
            color: #f8fafc;
        }

        [data-theme="dark"] .option-description {
            color: #94a3b8;
        }

        [data-theme="dark"] .close-button {
            background: #334155;
            color: #94a3b8;
        }

        [data-theme="dark"] .close-button:hover {
            background: #475569;
            color: #f8fafc;
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 640px) {
            .calendar-modal-content {
                width: 95vw;
                margin: 20px;
            }

            .calendar-modal-header {
                padding: 20px 20px 16px 20px;
            }

            .calendar-modal-body {
                padding: 20px;
            }

            .calendar-option {
                padding: 16px;
                gap: 12px;
            }

            .option-icon {
                width: 48px;
                height: 48px;
            }

            .option-title {
                font-size: 16px;
            }

            .option-description {
                font-size: 13px;
            }
        }

        /* í™•ëŒ€ëœ ì„¤ì • ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .settings-modal-content {
            overflow-y: auto !important;
            max-width: 1200px !important;
            width: 80vw !important;
            height: 85vh !important;
            max-height: none !important;
        }

        /* í”Œë«í¼ ìƒíƒœ ê·¸ë¦¬ë“œ */
        .platform-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .platform-stat-card {
            background: #f5f5f5;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        [data-theme="dark"] .platform-stat-card {
            background: #2a2a2a;
        }

        .platform-stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #3b82f6;
            margin-bottom: 0.5rem;
        }

        .platform-stat-label {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .platform-stat-desc {
            font-size: 0.8rem;
            color: #666;
            line-height: 1.4;
        }

        /* í”Œë«í¼ ì—°ê²° ê´€ë¦¬ */
        .platform-connections {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1rem;
        }

        .platform-connection-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: #f5f5f5;
            border-radius: 8px;
            border: 1px solid #e5e5e5;
        }

        [data-theme="dark"] .platform-connection-item {
            background: #2a2a2a;
            border-color: #444;
        }

        .platform-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 8px;
            color: #333;
        }

        [data-theme="dark"] .platform-icon {
            background: #1a1a1a;
            color: #fff;
        }

        .platform-info {
            flex: 1;
        }

        .platform-info h4 {
            margin: 0 0 0.25rem 0;
            font-size: 1rem;
        }

        .platform-status {
            font-size: 0.85rem;
            color: #666;
        }

        .platform-status.connected {
            color: #10b981;
        }

        .platform-connect-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #3b82f6;
            background: white;
            color: #3b82f6;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .platform-connect-btn:hover {
            background: #3b82f6;
            color: white;
        }

        .platform-connect-btn.connected {
            border-color: #dc2626;
            color: #dc2626;
        }

        .platform-connect-btn.connected:hover {
            background: #dc2626;
            color: white;
        }

        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        .settings-modal-content::-webkit-scrollbar {
            width: 8px;
        }

        .settings-modal-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .settings-modal-content::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        .settings-modal-content::-webkit-scrollbar-thumb:hover {
            background: #555;
        }


        /* ì–¸ì–´ ë“œë¡­ë‹¤ìš´ ìŠ¤íƒ€ì¼ ê°œì„  */
        .language-dropdown {
            background: white !important;
            border: 1px solid #ddd !important;
            border-radius: 8px !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
            position: absolute !important;
            top: 100% !important;
            left: 0 !important;
            right: 0 !important;
            z-index: 1000 !important;
            margin-top: 4px !important;
        }

        [data-theme="dark"] .language-dropdown {
            background: #2a2a2a !important;
            border-color: #444 !important;
        }

        .language-option {
            display: flex !important;
            align-items: center !important;
            gap: 8px !important;
            padding: 12px !important;
            cursor: pointer !important;
            transition: background-color 0.2s !important;
        }

        .language-option:hover {
            background-color: #f5f5f5 !important;
        }

        [data-theme="dark"] .language-option:hover {
            background-color: #333 !important;
        }

        /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ì„¹ì…˜ ìœ„ì¹˜ ì¡°ì • */
        .nav-section-bottom {
            margin-top: -12px !important;
        }

        .nav-section-bottom .nav-item {
            padding-top: 8px !important;
            padding-bottom: 8px !important;
        }

        /* ì‚¬ì´ë“œë°” í”„ë¡œí•„ ì•„ë°”íƒ€ ìŠ¤íƒ€ì¼ */
        .profile-avatar-icon {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            padding: 0 !important;
            width: 32px !important;
            height: 32px !important;
            position: relative !important;
        }

        .sidebar-avatar {
            width: 28px !important;
            height: 28px !important;
            min-width: 28px !important;
            min-height: 28px !important;
            max-width: 28px !important;
            max-height: 28px !important;
            border-radius: 50% !important;
            object-fit: cover !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
            transition: all 0.2s ease !important;
            display: block !important;
            flex-shrink: 0 !important;
        }

        .profile-nav-item:hover .sidebar-avatar {
            border-color: rgba(255, 255, 255, 0.4) !important;
            transform: scale(1.05) !important;
        }

        .profile-nav-item.active .sidebar-avatar {
            border-color: rgba(255, 255, 255, 0.6) !important;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2) !important;
        }

        /* ì ‘íŒ ìƒíƒœì—ì„œ ì•„ë°”íƒ€ ì¤‘ì•™ ì •ë ¬ */
        .sidebar.collapsed .profile-avatar-icon {
            margin: 0 auto !important;
            width: 36px !important;
            height: 36px !important;
            z-index: 10003 !important;
            /* í—¤ë”ë³´ë‹¤ ìœ„ì— í‘œì‹œ */
            position: relative !important;
        }

        .sidebar.collapsed .sidebar-avatar {
            width: 32px !important;
            height: 32px !important;
            min-width: 32px !important;
            min-height: 32px !important;
            max-width: 32px !important;
            max-height: 32px !important;
            z-index: 10003 !important;
            /* í—¤ë”ë³´ë‹¤ ìœ„ì— í‘œì‹œ */
            position: relative !important;
        }

        /* ì ‘íŒ ìƒíƒœì—ì„œ ëª¨ë“  ë„¤ë¹„ê²Œì´ì…˜ ì•„ì´í…œë“¤ì„ í—¤ë” ìœ„ì— í‘œì‹œ */
        .sidebar.collapsed .nav-item {
            z-index: 10003 !important;
            position: relative !important;
        }

        /* ì‚¬ì´ë“œë°” í—¤ë” ì»¨í…Œì´ë„ˆ */
        .sidebar-header-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px 8px 16px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.5);
            margin-bottom: 8px;
        }

        /* NotionFlow ë¡œê³  í…ìŠ¤íŠ¸ */
        .sidebar-logo {
            display: flex;
            align-items: center;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: -0.02em;
            user-select: none;
        }

        .sidebar-toggle-btn-internal {
            width: 32px;
            height: 32px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            color: rgba(255, 255, 255, 0.7);
        }

        .sidebar-toggle-btn-internal:hover {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            transform: scale(1.05);
        }

        .sidebar-toggle-btn-internal svg {
            width: 16px;
            height: 16px;
            transition: transform 0.2s ease;
        }

        /* ì ‘íŒ ìƒíƒœì—ì„œëŠ” ë¡œê³  ìˆ¨ê¸°ê³  í† ê¸€ ë²„íŠ¼ ì¤‘ì•™ ì •ë ¬ */
        .sidebar.collapsed .sidebar-header-container {
            justify-content: center;
            padding: 12px 8px 8px 8px;
        }

        .sidebar.collapsed .sidebar-logo {
            display: none;
        }

        .sidebar.collapsed .sidebar-toggle-btn-internal {
            background: rgba(255, 255, 255, 0.15);
        }

        /* ì•„ì´ì½˜ í‘œì‹œ/ìˆ¨ê¹€ */
        #sidebar-toggle-icon {
            display: block;
        }

        #sidebar-collapsed-icon {
            display: none;
        }

        .sidebar.collapsed #sidebar-toggle-icon {
            display: none;
        }

        .sidebar.collapsed #sidebar-collapsed-icon {
            display: block;
        }

        /* ë‹¤í¬ ëª¨ë“œì—ì„œ í† ê¸€ ë²„íŠ¼ border ì œê±° */
        [data-theme="dark"] .sidebar-toggle-btn-internal {
            border: none !important;
        }

        /* ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ìŠ¤íƒ€ì¼ */
        .context-menu {
            position: fixed;
            background: white;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10001;
            min-width: 150px;
            padding: 4px 0;
        }

        .context-menu-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
            color: #333;
            transition: background-color 0.2s ease;
        }

        .context-menu-item:hover {
            background-color: #f5f5f5;
        }

        .context-menu-item-danger {
            color: #dc2626;
        }

        .context-menu-item-danger:hover {
            background-color: #fef2f2;
        }

        .context-menu-item svg {
            flex-shrink: 0;
        }

        /* ìº˜ë¦°ë” ì•„ì´í…œ ìš°í´ë¦­ í‘œì‹œ */
        .calendar-item {
            position: relative;
        }

        .calendar-item.context-active {
            background-color: rgba(66, 133, 244, 0.1);
        }

        /* ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .modal-container {
            background: white;
            border-radius: 12px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #e5e5e5;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            padding: 0.5rem;
            line-height: 1;
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            padding: 1.5rem 2rem;
            border-top: 1px solid #e5e5e5;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.2s ease;
            box-sizing: border-box;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4285f4;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: #4285f4;
            color: white;
        }

        .btn-primary:hover {
            background: #3367d6;
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e5e5e5;
        }

        .loading-spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        /* í…Œë§ˆ ê°•ì œ ì ìš© ìŠ¤íƒ€ì¼ */
        [data-theme="light"] body,
        [data-theme="light"] .main-content,
        [data-theme="light"] .dashboard-section {
            background: #ffffff !important;
            color: #000000 !important;
        }

        [data-theme="dark"] body,
        [data-theme="dark"] .main-content,
        [data-theme="dark"] .dashboard-section {
            background: #141414 !important;
            color: #ffffff !important;
        }

        /* ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ì€ sidebar.cssì—ì„œ í†µì¼ ê´€ë¦¬ */

        /* Media Player Widget ìŠ¤íƒ€ì¼ */
        .media-player-section {
            margin: 12px 0;
        }

        .media-player-widget {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .media-player-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            font-weight: 600;
        }

        .media-player-icon {
            font-size: 16px;
        }

        .media-player-title {
            font-size: 13px;
        }

        .media-player-content {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .media-info {
            text-align: center;
        }

        .media-title {
            color: rgba(255, 255, 255, 0.95);
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .media-artist {
            color: rgba(255, 255, 255, 0.7);
            font-size: 11px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .media-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }

        .media-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: rgba(255, 255, 255, 0.9);
        }

        .media-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .media-btn-play {
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }

        .media-btn-play:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.1);
        }

        .media-progress {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }

        .progress-fill {
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            width: 0%;
            transition: width 0.1s ease;
        }

        .time-info {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* ì ‘íŒ ìƒíƒœì—ì„œ ë¯¸ë””ì–´ í”Œë ˆì´ì–´ ìˆ¨ê¹€ */
        .sidebar.collapsed .media-player-section {
            display: none;
        }

        /* ë‹¤í¬ ëª¨ë“œì—ì„œ ë¯¸ë””ì–´ í”Œë ˆì´ì–´ ìŠ¤íƒ€ì¼ */
        [data-theme="dark"] .media-player-widget {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.1);
        }

        /* ì„¤ì • ëª¨ë‹¬ë„ í…Œë§ˆ ì ìš© */
        [data-theme="light"] .calendar-modal-content,
        [data-theme="light"] .settings-modal-content {
            background: #ffffff !important;
            color: #000000 !important;
        }

        [data-theme="dark"] .calendar-modal-content,
        [data-theme="dark"] .settings-modal-content {
            color: #ffffff !important;
        }

        [data-theme="light"] .settings-section {
            color: #000000 !important;
        }

        [data-theme="dark"] .settings-section {
            color: #ffffff !important;
        }

        [data-theme="light"] .settings-section-title {
            color: #000000 !important;
        }

        [data-theme="dark"] .settings-section-title {
            color: #ffffff !important;
        }

        [data-theme="light"] .settings-section-desc {
            color: #666666 !important;
        }

        [data-theme="dark"] .settings-section-desc {
            color: #999999 !important;
        }
    </style>
    <script>

        // í”Œë«í¼ ì—°ê²° ê´€ë ¨ í•¨ìˆ˜ë“¤
        function connectPlatform(platform) {
            console.log(`Connecting to ${platform}...`);
            // í”Œë«í¼ ì—°ê²° ë¡œì§
        }

        function disconnectPlatform(platform) {
            console.log(`Disconnecting from ${platform}...`);
            // í”Œë«í¼ ì—°ê²° í•´ì œ ë¡œì§
        }

        function logoutUser() {
            if (confirm('ì •ë§ ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                console.log('Logging out...');
                // ë¡œê·¸ì•„ì›ƒ ë¡œì§
                window.location.href = '/logout';
            }
        }

        // ì„¤ì • ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function closeSettingsModal() {
            document.getElementById('settings-modal').style.display = 'none';
        }

        // ê¸°íƒ€ ì„¤ì • ê´€ë ¨ í•¨ìˆ˜ë“¤
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('settingsLanguageDropdown');
            if (dropdown) {
                dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
            }
        }

        function setLanguage(lang) {
            console.log(`Setting language to: ${lang}`);

            // ì–¸ì–´ ì„¤ì • ì €ì¥
            localStorage.setItem('language', lang);

            // ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            const toggleBtn = document.getElementById('settingsLanguageToggle');
            if (toggleBtn) {
                const flagSpan = toggleBtn.querySelector('.lang-flag');
                const textSpan = toggleBtn.querySelector('.lang-text');

                if (lang === 'ko') {
                    flagSpan.textContent = 'ğŸ‡°ğŸ‡·';
                    textSpan.textContent = 'í•œêµ­ì–´';
                } else if (lang === 'en') {
                    flagSpan.textContent = 'ğŸ‡ºğŸ‡¸';
                    textSpan.textContent = 'English';
                }
            }

            // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
            toggleLanguageDropdown();
        }

        function navigateToApiKeys() {
            console.log('Navigating to API keys...');

            // Try to get encrypted identifiers from various sources
            let encryptedId = '';
            let encryptedEmail = '';

            if (window.notionFlowConfig && window.notionFlowConfig.encryptedUserId) {
                encryptedId = window.notionFlowConfig.encryptedUserId;
                encryptedEmail = window.notionFlowConfig.encryptedEmail;
            } else if (window.dashboardData && window.dashboardData.encrypted_user_id) {
                encryptedId = window.dashboardData.encrypted_user_id;
                encryptedEmail = window.dashboardData.encrypted_email;
            }

            // Choose the appropriate URL format - encrypted ID/email after api-keys
            let targetUrl = '/dashboard/api-keys';
            if (encryptedId) {
                targetUrl = `/dashboard/api-keys/${encryptedId}`;
            } else if (encryptedEmail) {
                targetUrl = `/dashboard/api-keys/${encryptedEmail}`;
            }

            console.log('Target URL:', targetUrl);

            // ì„¤ì • ëª¨ë‹¬ ë‹«ê¸° (if it exists)
            if (typeof closeSettingsModal === 'function') {
                closeSettingsModal();
            }

            // API í‚¤ í˜ì´ì§€ë¡œ ì´ë™
            window.location.href = targetUrl;
        }

        // í…Œë§ˆ ì´ˆê¸°í™” (í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ ì‹¤í–‰)
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            console.log('Theme initialized:', savedTheme);
        }

        // ThemeManagerì™€ ì¶©ëŒí•˜ì§€ ì•Šë„ë¡ ê°„ë‹¨íˆ ìˆ˜ì •
        function ensureThemeToggleWorks() {
            console.log('ğŸ”§ Ensuring theme toggle works...');

            // ThemeManagerê°€ ì´ë¯¸ ì²˜ë¦¬í•˜ê³  ìˆìœ¼ë¯€ë¡œ onclick í•¸ë“¤ëŸ¬ë§Œ í™•ì¸
            const toggle = document.getElementById('theme-toggle');
            if (toggle) {
                console.log('âœ… Theme toggle found, ultraForceToggle ready');
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì¦‰ì‹œ í…Œë§ˆ ì ìš©
        initializeTheme();




        // ì„¤ì • ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function openSettingsModal() {
            document.getElementById('settings-modal').style.display = 'flex';
        }



        // ì ‘íŒ ìƒíƒœì—ì„œ ì•„ì´ì½˜ í´ë¦­ ì‹œ ì‚¬ì´ë“œë°” í¼ì¹˜ê¸° ë˜ëŠ” ê¸°ë³¸ ë™ì‘
        function handleSidebarItemClick(section) {
            const sidebar = document.getElementById('sidebar');
            if (!sidebar) return;

            // ì‚¬ì´ë“œë°”ê°€ ì ‘í˜€ìˆìœ¼ë©´ í¼ì¹˜ê¸°ë§Œ í•¨
            if (sidebar.classList.contains('collapsed')) {
                toggleSidebar();
                return; // ë‹¤ë¥¸ ë™ì‘ì€ í•˜ì§€ ì•ŠìŒ
            }

            // í¼ì³ì ¸ ìˆìœ¼ë©´ ì›ë˜ ê¸°ëŠ¥ ì‹¤í–‰
            switch (section) {
                case 'profile':
                    if (typeof navigateToSection === 'function') {
                        navigateToSection('profile');
                    } else {
                        window.location.href = '/profile';
                    }
                    break;
                case 'overview':
                    if (typeof navigateToSection === 'function') {
                        navigateToSection('overview');
                    }
                    break;
                case 'sync':
                    if (typeof navigateToSection === 'function') {
                        navigateToSection('sync');
                    }
                    break;
                case 'calendar':
                    window.location.href = '/dashboard/calendar-detail';
                    break;
                case 'friends':
                    window.location.href = '/friends';
                    break;
                case 'api-keys':
                    if (typeof navigateToApiKeys === 'function') {
                        navigateToApiKeys();
                    }
                    break;
                case 'calendar-list':
                    window.location.href = '/dashboard/calendar-list';
                    break;
                case 'settings':
                    window.location.href = '/dashboard/settings';
                    break;
                default:
                    console.log('Unknown section:', section);
            }
        }

        // ì‚¬ì´ë“œë°” í† ê¸€ ê¸°ëŠ¥ - ê°„ë‹¨í•˜ê³  í™•ì‹¤í•œ ë²„ì „
        function toggleSidebar() {
            console.log('ğŸ”„ Toggle sidebar clicked');

            const sidebar = document.getElementById('sidebar');
            if (!sidebar) {
                console.error('âŒ Sidebar not found');
                return;
            }

            // í† ê¸€ ì‹¤í–‰
            sidebar.classList.toggle('collapsed');
            const isCollapsed = sidebar.classList.contains('collapsed');

            // console.log('âœ… Sidebar toggled:', isCollapsed ? 'collapsed' : 'expanded');

            // ë¶€ëª¨ ì»¨í…Œì´ë„ˆ í´ë˜ìŠ¤ ì—…ë°ì´íŠ¸ (ì„ íƒì‚¬í•­)
            const dashboardLayout = document.querySelector('.dashboard-layout');
            if (dashboardLayout) {
                if (isCollapsed) {
                    dashboardLayout.classList.add('sidebar-collapsed');
                } else {
                    dashboardLayout.classList.remove('sidebar-collapsed');
                }
            }

            // ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
            updateToggleIcons(isCollapsed);

            // í˜ì´ì§€ë³„ ìƒíƒœ ì €ì¥
            const currentPage = getCurrentPageType();
            localStorage.setItem(`sidebar-collapsed-${currentPage}`, isCollapsed);
        }

        // í† ê¸€ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateToggleIcons(isCollapsed) {
            const toggleIcon = document.getElementById('sidebar-toggle-icon');
            const collapsedIcon = document.getElementById('sidebar-collapsed-icon');

            if (toggleIcon && collapsedIcon) {
                if (isCollapsed) {
                    toggleIcon.style.display = 'none';
                    collapsedIcon.style.display = 'block';
                } else {
                    toggleIcon.style.display = 'block';
                    collapsedIcon.style.display = 'none';
                }
                console.log('ğŸ¯ Icons updated for collapsed state:', isCollapsed);
            } else {
                console.warn('âš ï¸ Toggle icons not found');
            }
        }


        // í˜„ì¬ í˜ì´ì§€ íƒ€ì… ê°€ì ¸ì˜¤ê¸°
        function getCurrentPageType() {
            if (document.body.classList.contains('calendar-detail-page') || 
                window.location.pathname.includes('/calendar-detail') ||
                document.querySelector('.calendar-workspace')) {
                return 'calendar-detail';
            } else if (document.body.classList.contains('calendar-list-page') ||
                      window.location.pathname.includes('/calendar-list')) {
                return 'calendar-list';
            } else {
                return 'default';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ì‚¬ì´ë“œë°” ìƒíƒœ ë³µì›
        function restoreSidebarState() {
            console.log('ğŸ”„ Restoring sidebar state...');

            const currentPage = getCurrentPageType();
            const isCollapsed = localStorage.getItem(`sidebar-collapsed-${currentPage}`) === 'true';
            const sidebar = document.getElementById('sidebar');

            if (!sidebar) {
                console.warn('âš ï¸ Sidebar not found during state restoration');
                return;
            }

            if (isCollapsed) {
                sidebar.classList.add('collapsed');
                // console.log('âœ… Sidebar restored to collapsed state');

                // ë¶€ëª¨ ì»¨í…Œì´ë„ˆë„ ì—…ë°ì´íŠ¸
                const dashboardLayout = document.querySelector('.dashboard-layout');
                if (dashboardLayout) {
                    dashboardLayout.classList.add('sidebar-collapsed');
                }

                // ì•„ì´ì½˜ ìƒíƒœ ë³µì›
                updateToggleIcons(true);
            } else {
                // console.log('âœ… Sidebar restored to expanded state');
                updateToggleIcons(false);
            }
        }

        // Avatar generation helper functions (same as in friends.js)
        function generateAvatarColor(name) {
            if (!name) return '#9333ea'; // ê¸°ë³¸ ë³´ë¼ìƒ‰
            
            const colors = [
                '#ef4444', '#f97316', '#f59e0b', '#eab308', '#84cc16',
                '#22c55e', '#10b981', '#14b8a6', '#06b6d4', '#0ea5e9',
                '#3b82f6', '#6366f1', '#8b5cf6', '#a855f7', '#d946ef',
                '#ec4899', '#f43f5e', '#9333ea'
            ];
            
            let hash = 0;
            for (let i = 0; i < name.length; i++) {
                const char = name.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            
            return colors[Math.abs(hash) % colors.length];
        }

        function generateUserAvatar(name) {
            if (!name) name = 'ì‚¬ìš©ì';
            const initial = name.charAt(0).toUpperCase();
            const color = generateAvatarColor(name);
            
            const svg = `<svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
                <rect width="32" height="32" fill="${color}" rx="16"/>
                <text x="50%" y="50%" text-anchor="middle" dy="0.35em" fill="white" font-family="system-ui, -apple-system, sans-serif" font-size="14" font-weight="600">${initial}</text>
            </svg>`;
            
            // URL ì¸ì½”ë”©ì„ ì‚¬ìš©í•˜ì—¬ í•œê¸€ ë¬¸ì ì§€ì›
            return `data:image/svg+xml;charset=utf-8,${encodeURIComponent(svg)}`;
        }

        // ì‚¬ìš©ì í”„ë¡œí•„ ì•„ë°”íƒ€ ë¡œë“œ í•¨ìˆ˜ (ì‹¤ì œ í”„ë¡œí•„ ë°ì´í„° ì‚¬ìš©)
        async function loadUserAvatar() {
            const sidebarAvatar = document.getElementById('sidebar-profile-avatar');
            if (!sidebarAvatar) {
                console.warn('âŒ Sidebar avatar element not found');
                return;
            }

            // ì¦‰ì‹œ ê¸°ë³¸ ì•„ë°”íƒ€ ì„¤ì • (ë¡œë”© ì¤‘ì—ë„ ë¬´ì–¸ê°€ ë³´ì´ë„ë¡)
            sidebarAvatar.src = generateUserAvatar('ì‚¬ìš©ì');

            try {
                // APIë¥¼ í†µí•´ ì‹¤ì œ ì‚¬ìš©ì í”„ë¡œí•„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const response = await fetch('/api/profile');
                
                if (!response.ok) {
                    console.warn('âš ï¸ Profile API response not OK:', response.status);
                    return;
                }

                const data = await response.json();
                
                if (data.success && data.profile) {
                    const profile = data.profile;
                    const userName = profile.display_name || profile.username || 'ì‚¬ìš©ì';
                    
                    console.log('ğŸ‘¤ Profile data loaded:', { 
                        display_name: profile.display_name, 
                        username: profile.username, 
                        avatar_url: profile.avatar_url 
                    });
                    
                    // ì—…ë¡œë“œëœ ì•„ë°”íƒ€ê°€ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©, ì—†ìœ¼ë©´ ì´ë‹ˆì…œ ì•„ë°”íƒ€ ìƒì„±
                    if (profile.avatar_url && profile.avatar_url.trim() !== '') {
                        // ì´ë¯¸ì§€ ë¡œë“œ í…ŒìŠ¤íŠ¸
                        const img = new Image();
                        img.onload = function() {
                            sidebarAvatar.src = profile.avatar_url;
                            console.log('ğŸ–¼ï¸ Using uploaded avatar from profile:', profile.avatar_url);
                        };
                        img.onerror = function() {
                            console.warn('âš ï¸ Avatar image failed to load, using generated avatar');
                            sidebarAvatar.src = generateUserAvatar(userName);
                        };
                        img.src = profile.avatar_url;
                    } else {
                        sidebarAvatar.src = generateUserAvatar(userName);
                        console.log('ğŸ¨ Generated avatar for user:', userName);
                    }
                } else {
                    console.warn('âš ï¸ Profile API returned unsuccessful response:', data);
                }
            } catch (error) {
                console.error('âŒ Error loading user avatar:', error);
                // ì˜¤ë¥˜ ë°œìƒì‹œì—ë„ ê¸°ë³¸ ì•„ë°”íƒ€ëŠ” ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆìŒ
            }
        }

        // Mini Calendar Functions
        function generateMiniCalendar() {
            const monthGrid = document.getElementById('month-grid');
            if (!monthGrid) return;

            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const today = now.getDate();

            // Get first day of month and total days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();

            monthGrid.innerHTML = '';

            // Previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = daysInPrevMonth - i;
                const cell = document.createElement('div');
                cell.className = 'calendar-cell other-month';
                cell.textContent = day;
                monthGrid.appendChild(cell);
            }

            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('div');
                cell.className = 'calendar-cell';
                if (day === today) {
                    cell.classList.add('today');
                }
                cell.textContent = day;
                cell.onclick = () => handleMiniCalendarClick(year, month, day);
                monthGrid.appendChild(cell);
            }

            // Next month days
            const totalCells = monthGrid.children.length;
            const remainingCells = totalCells % 7 === 0 ? 0 : 7 - (totalCells % 7);
            for (let day = 1; day <= remainingCells; day++) {
                const cell = document.createElement('div');
                cell.className = 'calendar-cell other-month';
                cell.textContent = day;
                monthGrid.appendChild(cell);
            }
        }

        function handleMiniCalendarClick(year, month, day) {
            // Open day modal with selected date
            const selectedDate = new Date(year, month, day);
            
            // If we're on the calendar detail page, open the modal
            if (typeof openDayModal === 'function') {
                openDayModal(selectedDate);
            } else {
                // Otherwise, navigate to calendar detail page with date parameter
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                window.location.href = `/dashboard/calendar-detail?date=${dateStr}`;
            }
        }

        // Sidebar Media Player Functions
        let sidebarMediaPlayer = null;
        let currentTrackIndex = 0;
        let sidebarTracks = [];

        function initializeSidebarMediaPlayer() {
            console.log('ğŸµ Initializing sidebar media player...');
            
            // Get media data from the main page
            const workspace = document.querySelector('.calendar-workspace');
            if (workspace && workspace.dataset.calendarMedia) {
                const mediaUrl = workspace.dataset.calendarMedia;
                const mediaTitle = workspace.dataset.calendarMediaTitle || 'Unknown Track';
                const mediaType = workspace.dataset.calendarMediaType || 'audio';
                
                if (mediaUrl && mediaUrl !== '' && mediaUrl !== 'None') {
                    sidebarTracks = [{
                        title: mediaTitle,
                        artist: 'ë‚´ ìŒì•…',
                        src: mediaUrl,
                        type: mediaType
                    }];
                    
                    updateSidebarMediaInfo(sidebarTracks[0]);
                    console.log('âœ… Sidebar media player initialized with track:', mediaTitle);
                } else {
                    updateSidebarMediaInfo(null);
                }
            } else {
                updateSidebarMediaInfo(null);
            }
        }

        function updateSidebarMediaInfo(track) {
            const titleEl = document.getElementById('sidebar-media-title');
            const artistEl = document.getElementById('sidebar-media-artist');
            
            if (track) {
                if (titleEl) titleEl.textContent = track.title || 'Unknown Track';
                if (artistEl) artistEl.textContent = track.artist || 'Unknown Artist';
            } else {
                if (titleEl) titleEl.textContent = 'ë¯¸ë””ì–´ ì—†ìŒ';
                if (artistEl) artistEl.textContent = 'ìº˜ë¦°ë”';
            }
        }

        function sidebarTogglePlay() {
            if (!sidebarTracks || sidebarTracks.length === 0) {
                console.warn('âš ï¸ No tracks available in sidebar player');
                return;
            }

            // Try to use the main media player if available
            if (window.mediaPlayer && typeof togglePlay === 'function') {
                togglePlay();
                updateSidebarPlayButton();
            } else {
                console.warn('âš ï¸ Main media player not available');
            }
        }

        function sidebarPrevTrack() {
            if (typeof prevTrack === 'function') {
                prevTrack();
                updateSidebarFromMainPlayer();
            }
        }

        function sidebarNextTrack() {
            if (typeof nextTrack === 'function') {
                nextTrack();
                updateSidebarFromMainPlayer();
            }
        }

        function updateSidebarPlayButton() {
            const playBtn = document.getElementById('sidebar-play-btn');
            const playIcon = playBtn?.querySelector('.play-icon');
            const pauseIcon = playBtn?.querySelector('.pause-icon');
            
            if (window.mediaPlayer && !window.mediaPlayer.paused) {
                playIcon?.style.setProperty('display', 'none');
                pauseIcon?.style.setProperty('display', 'block');
            } else {
                playIcon?.style.setProperty('display', 'block');
                pauseIcon?.style.setProperty('display', 'none');
            }
        }

        function updateSidebarProgress() {
            if (!window.mediaPlayer) return;
            
            const progressFill = document.getElementById('sidebar-progress-fill');
            const currentTimeEl = document.getElementById('sidebar-current-time');
            const totalTimeEl = document.getElementById('sidebar-total-time');
            
            if (progressFill && window.mediaPlayer.duration) {
                const progress = (window.mediaPlayer.currentTime / window.mediaPlayer.duration) * 100;
                progressFill.style.width = progress + '%';
            }
            
            if (currentTimeEl && window.mediaPlayer.currentTime) {
                currentTimeEl.textContent = formatTime(window.mediaPlayer.currentTime);
            }
            
            if (totalTimeEl && window.mediaPlayer.duration) {
                totalTimeEl.textContent = formatTime(window.mediaPlayer.duration);
            }
        }

        function updateSidebarFromMainPlayer() {
            // Update sidebar when main player changes track
            if (window.currentTracks && window.currentTrackIndex !== undefined) {
                const track = window.currentTracks[window.currentTrackIndex];
                if (track) {
                    updateSidebarMediaInfo(track);
                }
            }
            updateSidebarPlayButton();
        }

        function formatTime(seconds) {
            if (isNaN(seconds)) return '00:00';
            
            const totalSecs = Math.floor(seconds);
            const hours = Math.floor(totalSecs / 3600);
            const mins = Math.floor((totalSecs % 3600) / 60);
            const secs = totalSecs % 60;
            
            if (hours > 0) {
                // 1ì‹œê°„ ì´ìƒ: 00:00:00 í˜•ì‹
                return (hours < 10 ? '0' : '') + hours + ':' + 
                       (mins < 10 ? '0' : '') + mins + ':' + 
                       (secs < 10 ? '0' : '') + secs;
            } else {
                // 1ì‹œê°„ ë¯¸ë§Œ: 00:00 í˜•ì‹ (ë¶„:ì´ˆ)
                return (mins < 10 ? '0' : '') + mins + ':' + 
                       (secs < 10 ? '0' : '') + secs;
            }
        }

        // Sync with main media player events
        function setupSidebarMediaSync() {
            if (window.mediaPlayer) {
                window.mediaPlayer.addEventListener('timeupdate', updateSidebarProgress);
                window.mediaPlayer.addEventListener('play', updateSidebarPlayButton);
                window.mediaPlayer.addEventListener('pause', updateSidebarPlayButton);
                window.mediaPlayer.addEventListener('ended', updateSidebarPlayButton);
                console.log('ğŸ”— Sidebar media player synced with main player');
            }
        }

        // Add DOM ready event listener
        document.addEventListener('DOMContentLoaded', function () {
            // ì‚¬ì´ë“œë°” ìƒíƒœ ë³µì›
            restoreSidebarState();

            // ê¸°ë³¸ ì‚¬ì´ë“œë°” ë§¤ë‹ˆì € ì´ˆê¸°í™” (sidebar.jsì—ì„œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë¨)
            if (typeof SidebarManager !== 'undefined') {
                const sidebarManager = new SidebarManager();
                sidebarManager.init();
            }

            // ì‚¬ìš©ì í”„ë¡œí•‘ ì•„ë°”íƒ€ ë¡œë“œ
            loadUserAvatar();

            // Ensure theme toggle works with ThemeManager
            ensureThemeToggleWorks();

            // Generate mini calendar only on calendar detail page
            const currentPage = getCurrentPageType();
            if (currentPage === 'calendar-detail') {
                console.log('âœ… Generating mini calendar for calendar detail page');
                generateMiniCalendar();
                
                // Initialize sidebar media player
                initializeSidebarMediaPlayer();
                
                // Setup media player sync after a short delay to ensure main player is ready
                setTimeout(() => {
                    setupSidebarMediaSync();
                }, 1000);
            } else {
                console.log('â„¹ï¸ Not generating mini calendar for page type:', currentPage);
            }
        });




    </script>
</div> <!-- sidebar ë‹«ê¸° -->
</div> <!-- sidebar-container ë‹«ê¸° -->