<!-- 
    ‚úÖ‚úÖ‚úÖ NOTIONFLOW SIDEBAR v5.0 - FIXED VERSION ‚úÖ‚úÖ‚úÖ
    =============================================
    CACHE BUSTER: {{ range(500000, 999999) | random }}
    DEPLOYED: 2025-08-07 01:20 KST - CALENDAR LIST MODE
    STATUS: showCalendarList() FUNCTION READY
    VERSION: 5.0 - DIRECT CALENDAR LIST UI
    =============================================
-->

<!-- Ï†ëÌûå ÏÉÅÌÉú Ï†ÑÏö© ÌñÑÎ≤ÑÍ±∞ Î≤ÑÌäº -->
<div class="collapsed-header">
    <button class="collapsed-toggle-btn" onclick="toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </button>
</div>

<!-- ÌéºÏ≥êÏßÑ ÏÉÅÌÉú Ï†ÑÏö© Ìó§Îçî - Î°úÍ≥†ÏôÄ ÌÜ†Í∏Ä Î≤ÑÌäº -->
<div class="expanded-header">
    <div class="sidebar-logo">
        <span class="logo-text">NodeFlow</span>
    </div>
    <button class="expanded-toggle-btn" onclick="toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
    </button>
</div>

<!-- ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Î©îÎâ¥ -->
<nav class="sidebar-nav">
    <!-- Î©îÏù∏ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò wrapper - Ïä§ÌÅ¨Î°§ Í∞ÄÎä• -->
    <div class="sidebar-main-nav">
        <!-- ÌîÑÎ°úÌïÑ ÏÑπÏÖò - ÏµúÏÉÅÎã® -->
        <div class="nav-section">
            <!-- ÌîÑÎ°úÌïÑ -->
            <div class="nav-item profile-nav-item {{ 'active' if current_page == 'profile' else '' }}"
                data-section="profile" onclick="handleSidebarItemClick('profile')">
                <span class="nav-icon profile-avatar-icon">
                    <img id="sidebar-profile-avatar" src="/static/images/default-avatar.svg" alt="ÌîÑÎ°úÌïÑ"
                        class="sidebar-avatar">
                </span>
                <span class="nav-label">ÌîÑÎ°úÌïÑ</span>
            </div>
        </div>

        <!-- Ï∫òÎ¶∞Îçî ÏÑπÏÖò -->
        <div class="nav-section">
            <div class="nav-item {{ 'active' if current_page == 'calendar-list' else '' }}" data-section="calendar-list"
                onclick="handleSidebarItemClick('calendar-list')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                        <line x1="16" y1="2" x2="16" y2="6" />
                        <line x1="8" y1="2" x2="8" y2="6" />
                        <line x1="3" y1="10" x2="21" y2="10" />
                    </svg>
                </span>
                <span class="nav-label">Ï∫òÎ¶∞Îçî Î™©Î°ù</span>
            </div>
        </div>

        <!-- Reminders Section (Calendar Detail Page Only) -->
        <div class="nav-section reminders-section calendar-detail-only">
            <div class="reminders-header">
                <span class="reminders-icon">üìù</span>
                <span class="reminders-title">Reminders</span>
            </div>
            <div class="reminders-content">
                <div class="reminder-item">
                    <span class="reminder-text">Î¶¨ÎßàÏù∏ÎçîÍ∞Ä ÏóÜÏäµÎãàÎã§</span>
                </div>
            </div>
        </div>

        <!-- Mini Calendar Widget (Calendar Detail Page Only) -->
        <div class="nav-section mini-calendar-section calendar-detail-only">
            <div class="mini-calendar-widget">
                <div class="calendar-view-container active" id="month-view">
                    <div class="compact-month-header">
                        <div class="compact-weekday-labels">
                            <div class="compact-weekday-label">Ïùº</div>
                            <div class="compact-weekday-label">Ïõî</div>
                            <div class="compact-weekday-label">Ìôî</div>
                            <div class="compact-weekday-label">Ïàò</div>
                            <div class="compact-weekday-label">Î™©</div>
                            <div class="compact-weekday-label">Í∏à</div>
                            <div class="compact-weekday-label">ÌÜ†</div>
                        </div>
                    </div>
                    
                    <div class="compact-month-grid" id="month-grid">
                        <!-- Calendar cells will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Í∏∞ÌÉÄ Í∏∞Îä• ÏÑπÏÖò -->
        <div class="nav-section">
            <!-- AI ÏïåÎ¶º ÏàòÏã†Ìï® (ÌîÑÎ¶¨ÎØ∏ÏóÑ Í∏∞Îä•) -->
            <div class="nav-item" onclick="handleSidebarItemClick('inbox')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                        <polyline points="22,6 12,13 2,6" />
                    </svg>
                </span>
                <span class="nav-label">ÏàòÏã†Ìï®</span>
                <span class="premium-badge">Pro</span>
            </div>
        </div>

        <!-- Ïó∞Í≤∞ & Í¥ÄÎ¶¨ ÏÑπÏÖò -->
        <div class="nav-section">

            <div class="nav-item {{ 'active' if current_page == 'friends' else '' }}" data-section="friends"
                onclick="handleSidebarItemClick('friends')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                        <circle cx="9" cy="7" r="4" />
                        <path d="m22 21-3-3m0 0a5 5 0 1 0-7 0l3 3" />
                    </svg>
                </span>
                <span class="nav-label">ÏπúÍµ¨</span>
                <span class="count-badge">0</span>
            </div>

            <div class="nav-item {{ 'active' if current_page == 'api-keys' else '' }}" data-section="api-keys"
                onclick="handleSidebarItemClick('api-keys')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="7.5" cy="15.5" r="5.5" />
                        <path d="m21 2-9.6 9.6" />
                        <path d="m15.5 7.5 3 3L22 7l-3-3" />
                    </svg>
                </span>
                <span class="nav-label">API ÌÇ§ Í¥ÄÎ¶¨</span>
            </div>

            <!-- ÏÑ§Ï†ï ÏïÑÏù¥ÏΩòÏùÑ Ïó∞Í≤∞ & Í¥ÄÎ¶¨ ÏÑπÏÖòÏúºÎ°ú Ïù¥Îèô -->
            <div class="nav-item {{ 'active' if current_page == 'settings' else '' }}"
                onclick="handleSidebarItemClick('settings')">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </span>
                <span class="nav-label">ÏÑ§Ï†ï</span>
            </div>

        </div>
    </div>
    <!-- Î©îÏù∏ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò wrapper ÎÅù -->

    <!-- ÌïòÎã® Í≥†Ï†ï ÏÑπÏÖò Ï†úÍ±∞ - ÏÑ§Ï†ï ÏïÑÏù¥ÏΩòÏù¥ Ïó∞Í≤∞ & Í¥ÄÎ¶¨ ÏÑπÏÖòÏúºÎ°ú Ïù¥ÎèôÎê® -->
</nav>
</div>


<!-- ÏÑ§Ï†ï Î™®Îã¨ -->
<div id="settings-modal" class="calendar-modal-overlay" style="display: none;">
    <div class="calendar-modal-content settings-modal-content">
        <div class="calendar-modal-header">
            <h2 class="calendar-modal-title">ÏÑ§Ï†ï</h2>
            <button class="calendar-modal-close" onclick="closeSettingsModal()">√ó</button>
        </div>

        <div class="calendar-modal-body">
            <!-- Ïñ∏Ïñ¥ ÏÑ§Ï†ï -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">Ïñ∏Ïñ¥</h3>
                    <p class="settings-section-desc">ÌëúÏãú Ïñ∏Ïñ¥Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</p>
                </div>
                <div class="language-toggle">
                    <button class="language-toggle-btn" id="settingsLanguageToggle" onclick="toggleLanguageDropdown()">
                        <span class="lang-flag">üá∞üá∑</span>
                        <span class="lang-text">ÌïúÍµ≠Ïñ¥</span>
                        <span class="toggle-arrow">‚åÑ</span>
                    </button>
                    <div class="language-dropdown" id="settingsLanguageDropdown" style="display: none;">
                        <div class="language-option" onclick="setLanguage('ko')">
                            <span class="lang-flag">üá∞üá∑</span>
                            <span class="lang-name">ÌïúÍµ≠Ïñ¥</span>
                        </div>
                        <div class="language-option" onclick="setLanguage('en')">
                            <span class="lang-flag">üá∫üá∏</span>
                            <span class="lang-name">English</span>
                        </div>
                    </div>
                </div>
            </div>


            <!-- ÌîåÎû´Ìèº ÏÉÅÌÉú -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">ÌîåÎû´Ìèº ÏÉÅÌÉú</h3>
                    <p class="settings-section-desc">Ïó∞Í≤∞Îêú ÌîåÎû´ÌèºÍ≥º ÎèôÍ∏∞Ìôî ÌòÑÌô©</p>
                </div>
                <div class="platform-stats-grid">
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">1,247</div>
                        <div class="platform-stat-label">ÎèôÍ∏∞ÌôîÎêú Ïù¥Î≤§Ìä∏</div>
                        <div class="platform-stat-desc">Ïù¥Î≤à Îã¨ Î™®Îì† ÌîåÎû´ÌèºÏóêÏÑú ÎèôÍ∏∞ÌôîÎêú Ï¥ù Ïù¥Î≤§Ìä∏ Ïàò</div>
                    </div>
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">60%</div>
                        <div class="platform-stat-label">ÌîåÎû´Ìèº Ïª§Î≤ÑÎ¶¨ÏßÄ</div>
                        <div class="platform-stat-desc">Ïó∞Í≤∞Îêú ÌîåÎû´Ìèº: Notion, Google Calendar, Apple Calendar</div>
                    </div>
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">24.5h</div>
                        <div class="platform-stat-label">Ï†àÏïΩÎêú ÏãúÍ∞Ñ</div>
                        <div class="platform-stat-desc">Ïù¥Î≤à Ï£º ÏûêÎèôÌôîÎ•º ÌÜµÌï¥ Ï†àÏïΩÎêú ÏòàÏÉÅ ÏãúÍ∞Ñ</div>
                    </div>
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">92%</div>
                        <div class="platform-stat-label">ÎèôÍ∏∞Ìôî ÏÑ±Í≥µÎ•†</div>
                        <div class="platform-stat-desc">ÏßÄÎÇú 30ÏùºÍ∞Ñ ÏÑ±Í≥µÏ†ÅÏù∏ ÎèôÍ∏∞Ìôî ÎπÑÏú®</div>
                    </div>
                </div>
            </div>

            <!-- ÌîåÎû´Ìèº Ïó∞Í≤∞ Í¥ÄÎ¶¨ -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">ÌîåÎû´Ìèº Ïó∞Í≤∞ Í¥ÄÎ¶¨</h3>
                    <p class="settings-section-desc">Í∞Å ÌîåÎû´ÌèºÏùò API ÌÇ§Î•º Í¥ÄÎ¶¨ÌïòÍ≥† Ïó∞Í≤∞ ÏÉÅÌÉúÎ•º ÌôïÏù∏ÌïòÏÑ∏Ïöî</p>
                </div>
                <div class="platform-connections">
                    <!-- Notion -->
                    <div class="platform-connection-item">
                        <div class="platform-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M4.459 4.208c.746.606 1.026.56 2.428.466l13.215-.793c.28 0 .047-.28-.046-.326L17.86 1.968c-.42-.326-.981-.7-2.055-.607L3.01 2.295c-.466.046-.56.28-.374.466zm.793 3.08v13.904c0 .747.373 1.027 1.214.98l14.523-.84c.841-.046 1.121-.56 1.121-1.167V6.354c0-.606-.233-.933-.747-.887l-15.177.887c-.56.047-.934.373-.934 1.027zm13.748.327c.093.42 0 .84-.42.888l-.7.14v10.264c-.608.327-1.168.514-1.635.514-.748 0-.935-.234-1.495-.933l-4.577-7.186v6.952L12.21 19s0 .84-1.168.84l-3.222.186c-.093-.186 0-.653.327-.746l.84-.233V9.854L7.822 9.76c-.094-.42.14-1.026.793-1.073l3.456-.233 4.764 7.279v-6.44l-1.215-.139c-.093-.514.28-.887.747-.933zM1.936 1.035l13.31-.98c1.634-.14 2.055-.047 3.082.7l4.249 2.986c.7.513.934.653.934 1.213v16.378c0 1.026-.373 1.634-1.68 1.726l-15.458.934c-.98.047-1.448-.093-1.962-.747l-3.129-4.06c-.56-.747-.793-1.306-.793-1.96V2.667c0-.839.374-1.54 1.447-1.632z" />
                            </svg>
                        </div>
                        <div class="platform-info">
                            <h4>Notion</h4>
                            <p class="platform-status">Ïó∞Í≤∞ÎêòÏßÄ ÏïäÏùå</p>
                        </div>
                        <button class="platform-connect-btn" onclick="connectPlatform('notion')">Ïó∞Í≤∞</button>
                    </div>
                    <!-- Google Calendar -->
                    <div class="platform-connection-item">
                        <div class="platform-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z" />
                            </svg>
                        </div>
                        <div class="platform-info">
                            <h4>Google Calendar</h4>
                            <p class="platform-status connected">Ïó∞Í≤∞Îê®</p>
                        </div>
                        <button class="platform-connect-btn connected" onclick="disconnectPlatform('google')">Ïó∞Í≤∞
                            Ìï¥Ï†ú</button>
                    </div>
                    <!-- Ï∂îÍ∞Ä ÌîåÎû´ÌèºÎì§... -->
                </div>
            </div>

            <!-- Îπ†Î•∏ Ïï°ÏÖò -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">Îπ†Î•∏ Ïï°ÏÖò</h3>
                </div>
                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="navigateToApiKeys()">
                        <span class="quick-action-icon">üîë</span>
                        <span class="quick-action-text">API ÌÇ§ Í¥ÄÎ¶¨</span>
                    </button>
                    <button class="quick-action-btn" onclick="logoutUser()">
                        <span class="quick-action-icon">üö™</span>
                        <span class="quick-action-text">Î°úÍ∑∏ÏïÑÏõÉ</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="calendar-modal-footer">
            <button class="calendar-btn-cancel" onclick="closeSettingsModal()">Îã´Í∏∞</button>
        </div>
    </div>
    <style>
        /* Ï∫òÎ¶∞Îçî Í¥ÄÎ†® Ïä§ÌÉÄÏùº ÏÇ≠Ï†úÎê® */
        .removed-calendar-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
            visibility: visible;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .calendar-creation-modal.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .modal-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            animation: fadeIn 0.2s ease-out;
        }

        .calendar-modal-container {
            position: relative;
            z-index: 10001;
            animation: slideInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .calendar-modal-content {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
            width: 440px;
            max-width: 90vw;
            max-height: 85vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .calendar-creation-modal.hidden .calendar-modal-content {
            transform: translateY(20px) scale(0.95);
        }

        /* Î™®Îã¨ Ìó§Îçî */
        .calendar-modal-header {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
            position: relative;
            background: #fafafa;
        }

        .header-icon {
            display: none;
            /* ÏïÑÏù¥ÏΩò Ï†úÍ±∞ÌïòÏó¨ Îçî ÍπîÎÅîÌïòÍ≤å */
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #111827;
            margin: 0;
            text-align: center;
        }

        .close-button {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            border-radius: 6px;
            color: #6b7280;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        .close-button:hover {
            background: #f3f4f6;
            color: #111827;
        }

        /* Î™®Îã¨ Î∞îÎîî */
        .calendar-modal-body {
            padding: 24px;
            overflow-y: auto;
            flex: 1;
        }

        /* ÎèôÏ†Å Ìèº Ïä§ÌÉÄÏùº */
        .calendar-form {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 4px;
        }

        .form-label svg {
            opacity: 0.7;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            color: #374151;
            background: #ffffff;
            transition: all 0.2s ease;
            box-sizing: border-box;
        }

        .form-input:focus {
            outline: none;
            border-color: #4285f4;
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }

        .form-helper {
            font-size: 12px;
            color: #6b7280;
            font-style: italic;
        }

        /* ÎùºÎîîÏò§ Í∑∏Î£π Ïä§ÌÉÄÏùº */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #ffffff;
        }

        .radio-option:hover {
            border-color: #d1d5db;
            background: #f9fafb;
        }

        .radio-option input[type="radio"] {
            display: none;
        }

        .radio-custom {
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            position: relative;
            transition: all 0.2s ease;
        }

        .radio-option input[type="radio"]:checked+.radio-custom {
            border-color: #4285f4;
            background: #4285f4;
        }

        .radio-option input[type="radio"]:checked+.radio-custom::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .radio-content {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .radio-title {
            font-size: 13px !important;
            font-weight: 600;
            color: #374151;
        }

        .radio-desc {
            font-size: 11px !important;
            color: #6b7280;
        }

        /* ÏÉâÏÉÅ ÌåîÎ†àÌä∏ Ïä§ÌÉÄÏùº */
        .color-palette {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 12px;
        }

        .color-palette input[type="radio"] {
            display: none;
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.1);
        }

        .color-option:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .color-palette input[type="radio"]:checked+.color-option {
            border-color: #111827;
            transform: scale(1.1);
            box-shadow: 0 0 0 2px #111827;
        }

        .color-palette input[type="radio"]:checked+.color-option::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 16px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* Î≤ÑÌäº Ïä§ÌÉÄÏùº */
        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 32px;
        }

        .btn-secondary,
        .btn-primary {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 100px;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .btn-primary {
            background: #2563eb;
            color: white;
            position: relative;
        }

        .btn-primary:hover {
            background: #3367d6;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
        }

        .btn-primary:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-loading {
            display: none;
        }

        .btn-primary.loading .btn-text {
            display: none;
        }

        .btn-primary.loading .btn-loading {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .loading-spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        /* Ïï†ÎãàÎ©îÏù¥ÏÖò ÌÇ§ÌîÑÎ†àÏûÑ */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        @keyframes dots {

            0%,
            20% {
                content: '.';
            }

            40% {
                content: '..';
            }

            60%,
            100% {
                content: '...';
            }
        }

        /* Îã§ÌÅ¨ Î™®Îìú ÏßÄÏõê */
        [data-theme="dark"] .calendar-modal-content {
            background: #1f2937;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        [data-theme="dark"] .modal-title {
            color: #f8fafc;
        }

        [data-theme="dark"] .modal-description {
            color: #94a3b8;
        }

        [data-theme="dark"] .calendar-option {
            background: #334155;
            border-color: #475569;
        }

        [data-theme="dark"] .calendar-option:hover {
            border-color: #64748b;
            background: #3f4f5f;
        }

        [data-theme="dark"] .option-title {
            color: #f8fafc;
        }

        [data-theme="dark"] .option-description {
            color: #94a3b8;
        }

        [data-theme="dark"] .close-button {
            background: #334155;
            color: #94a3b8;
        }

        [data-theme="dark"] .close-button:hover {
            background: #475569;
            color: #f8fafc;
        }

        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 640px) {
            .calendar-modal-content {
                width: 95vw;
                margin: 20px;
            }

            .calendar-modal-header {
                padding: 20px 20px 16px 20px;
            }

            .calendar-modal-body {
                padding: 20px;
            }

            .calendar-option {
                padding: 16px;
                gap: 12px;
            }

            .option-icon {
                width: 48px;
                height: 48px;
            }

            .option-title {
                font-size: 16px;
            }

            .option-description {
                font-size: 13px;
            }
        }

        /* ÌôïÎåÄÎêú ÏÑ§Ï†ï Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .settings-modal-content {
            overflow-y: auto !important;
            max-width: 1200px !important;
            width: 80vw !important;
            height: 85vh !important;
            max-height: none !important;
        }

        /* ÌîåÎû´Ìèº ÏÉÅÌÉú Í∑∏Î¶¨Îìú */
        .platform-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .platform-stat-card {
            background: #f5f5f5;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        [data-theme="dark"] .platform-stat-card {
            background: #2a2a2a;
        }

        .platform-stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #3b82f6;
            margin-bottom: 0.5rem;
        }

        .platform-stat-label {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .platform-stat-desc {
            font-size: 0.8rem;
            color: #666;
            line-height: 1.4;
        }

        /* ÌîåÎû´Ìèº Ïó∞Í≤∞ Í¥ÄÎ¶¨ */
        .platform-connections {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1rem;
        }

        .platform-connection-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: #f5f5f5;
            border-radius: 8px;
            border: 1px solid #e5e5e5;
        }

        [data-theme="dark"] .platform-connection-item {
            background: #2a2a2a;
            border-color: #444;
        }

        .platform-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 8px;
            color: #333;
        }

        [data-theme="dark"] .platform-icon {
            background: #1a1a1a;
            color: #fff;
        }

        .platform-info {
            flex: 1;
        }

        .platform-info h4 {
            margin: 0 0 0.25rem 0;
            font-size: 1rem;
        }

        .platform-status {
            font-size: 0.85rem;
            color: #666;
        }

        .platform-status.connected {
            color: #10b981;
        }

        .platform-connect-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #3b82f6;
            background: white;
            color: #3b82f6;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .platform-connect-btn:hover {
            background: #3b82f6;
            color: white;
        }

        .platform-connect-btn.connected {
            border-color: #dc2626;
            color: #dc2626;
        }

        .platform-connect-btn.connected:hover {
            background: #dc2626;
            color: white;
        }

        /* Ïä§ÌÅ¨Î°§Î∞î Ïä§ÌÉÄÏùº */
        .settings-modal-content::-webkit-scrollbar {
            width: 8px;
        }

        .settings-modal-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .settings-modal-content::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        .settings-modal-content::-webkit-scrollbar-thumb:hover {
            background: #555;
        }


        /* Ïñ∏Ïñ¥ ÎìúÎ°≠Îã§Ïö¥ Ïä§ÌÉÄÏùº Í∞úÏÑ† */
        .language-dropdown {
            background: white !important;
            border: 1px solid #ddd !important;
            border-radius: 8px !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
            position: absolute !important;
            top: 100% !important;
            left: 0 !important;
            right: 0 !important;
            z-index: 1000 !important;
            margin-top: 4px !important;
        }

        [data-theme="dark"] .language-dropdown {
            background: #2a2a2a !important;
            border-color: #444 !important;
        }

        .language-option {
            display: flex !important;
            align-items: center !important;
            gap: 8px !important;
            padding: 12px !important;
            cursor: pointer !important;
            transition: background-color 0.2s !important;
        }

        .language-option:hover {
            background-color: #f5f5f5 !important;
        }

        [data-theme="dark"] .language-option:hover {
            background-color: #333 !important;
        }

        /* ÌïòÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÏÑπÏÖò ÏúÑÏπò Ï°∞Ï†ï */
        .nav-section-bottom {
            margin-top: -12px !important;
        }

        .nav-section-bottom .nav-item {
            padding-top: 8px !important;
            padding-bottom: 8px !important;
        }

        /* ÏÇ¨Ïù¥ÎìúÎ∞î ÌîÑÎ°úÌïÑ ÏïÑÎ∞îÌÉÄ Ïä§ÌÉÄÏùº */
        .profile-avatar-icon {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            padding: 0 !important;
            width: 32px !important;
            height: 32px !important;
            position: relative !important;
        }

        .sidebar-avatar {
            width: 28px !important;
            height: 28px !important;
            min-width: 28px !important;
            min-height: 28px !important;
            max-width: 28px !important;
            max-height: 28px !important;
            border-radius: 50% !important;
            object-fit: cover !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
            transition: all 0.2s ease !important;
            display: block !important;
            flex-shrink: 0 !important;
        }

        .profile-nav-item:hover .sidebar-avatar {
            border-color: rgba(255, 255, 255, 0.4) !important;
            transform: scale(1.05) !important;
        }

        .profile-nav-item.active .sidebar-avatar {
            border-color: rgba(255, 255, 255, 0.6) !important;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2) !important;
        }

        /* Ï†ëÌûå ÏÉÅÌÉúÏóêÏÑú ÏïÑÎ∞îÌÉÄ Ï§ëÏïô Ï†ïÎ†¨ */
        .sidebar.collapsed .profile-avatar-icon {
            margin: 0 auto !important;
            width: 36px !important;
            height: 36px !important;
            z-index: 10003 !important;
            /* Ìó§ÎçîÎ≥¥Îã§ ÏúÑÏóê ÌëúÏãú */
            position: relative !important;
        }

        .sidebar.collapsed .sidebar-avatar {
            width: 32px !important;
            height: 32px !important;
            min-width: 32px !important;
            min-height: 32px !important;
            max-width: 32px !important;
            max-height: 32px !important;
            z-index: 10003 !important;
            /* Ìó§ÎçîÎ≥¥Îã§ ÏúÑÏóê ÌëúÏãú */
            position: relative !important;
        }

        /* Ï†ëÌûå ÏÉÅÌÉúÏóêÏÑú Î™®Îì† ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÏïÑÏù¥ÌÖúÎì§ÏùÑ Ìó§Îçî ÏúÑÏóê ÌëúÏãú */
        .sidebar.collapsed .nav-item {
            z-index: 10003 !important;
            position: relative !important;
        }

        /* ÏÇ¨Ïù¥ÎìúÎ∞î Ìó§Îçî Ïª®ÌÖåÏù¥ÎÑà */
        .sidebar-header-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px 8px 16px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.5);
            margin-bottom: 8px;
        }

        /* NotionFlow Î°úÍ≥† ÌÖçÏä§Ìä∏ */
        .sidebar-logo {
            display: flex;
            align-items: center;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: -0.02em;
            user-select: none;
        }

        .sidebar-toggle-btn-internal {
            width: 32px;
            height: 32px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            color: rgba(255, 255, 255, 0.7);
        }

        .sidebar-toggle-btn-internal:hover {
            background: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            transform: scale(1.05);
        }

        .sidebar-toggle-btn-internal svg {
            width: 16px;
            height: 16px;
            transition: transform 0.2s ease;
        }

        /* Ï†ëÌûå ÏÉÅÌÉúÏóêÏÑúÎäî Î°úÍ≥† Ïà®Í∏∞Í≥† ÌÜ†Í∏Ä Î≤ÑÌäº Ï§ëÏïô Ï†ïÎ†¨ */
        .sidebar.collapsed .sidebar-header-container {
            justify-content: center;
            padding: 12px 8px 8px 8px;
        }

        .sidebar.collapsed .sidebar-logo {
            display: none;
        }

        .sidebar.collapsed .sidebar-toggle-btn-internal {
            background: rgba(255, 255, 255, 0.15);
        }

        /* ÏïÑÏù¥ÏΩò ÌëúÏãú/Ïà®ÍπÄ */
        #sidebar-toggle-icon {
            display: block;
        }

        #sidebar-collapsed-icon {
            display: none;
        }

        .sidebar.collapsed #sidebar-toggle-icon {
            display: none;
        }

        .sidebar.collapsed #sidebar-collapsed-icon {
            display: block;
        }

        /* Îã§ÌÅ¨ Î™®ÎìúÏóêÏÑú ÌÜ†Í∏Ä Î≤ÑÌäº border Ï†úÍ±∞ */
        [data-theme="dark"] .sidebar-toggle-btn-internal {
            border: none !important;
        }

        /* Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ Ïä§ÌÉÄÏùº */
        .context-menu {
            position: fixed;
            background: white;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10001;
            min-width: 150px;
            padding: 4px 0;
        }

        .context-menu-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
            color: #333;
            transition: background-color 0.2s ease;
        }

        .context-menu-item:hover {
            background-color: #f5f5f5;
        }

        .context-menu-item-danger {
            color: #dc2626;
        }

        .context-menu-item-danger:hover {
            background-color: #fef2f2;
        }

        .context-menu-item svg {
            flex-shrink: 0;
        }

        /* Ï∫òÎ¶∞Îçî ÏïÑÏù¥ÌÖú Ïö∞ÌÅ¥Î¶≠ ÌëúÏãú */
        .calendar-item {
            position: relative;
        }

        .calendar-item.context-active {
            background-color: rgba(66, 133, 244, 0.1);
        }

        /* Î™®Îã¨ Ïò§Î≤ÑÎ†àÏù¥ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .modal-container {
            background: white;
            border-radius: 12px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #e5e5e5;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            padding: 0.5rem;
            line-height: 1;
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            padding: 1.5rem 2rem;
            border-top: 1px solid #e5e5e5;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.2s ease;
            box-sizing: border-box;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4285f4;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: #4285f4;
            color: white;
        }

        .btn-primary:hover {
            background: #3367d6;
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e5e5e5;
        }

        .loading-spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        /* ÌÖåÎßà Í∞ïÏ†ú Ï†ÅÏö© Ïä§ÌÉÄÏùº */
        [data-theme="light"] body,
        [data-theme="light"] .main-content,
        [data-theme="light"] .dashboard-section {
            background: #ffffff !important;
            color: #000000 !important;
        }

        [data-theme="dark"] body,
        [data-theme="dark"] .main-content,
        [data-theme="dark"] .dashboard-section {
            background: #141414 !important;
            color: #ffffff !important;
        }

        /* ÏÇ¨Ïù¥ÎìúÎ∞î Ïä§ÌÉÄÏùºÏùÄ sidebar.cssÏóêÏÑú ÌÜµÏùº Í¥ÄÎ¶¨ */

        /* ÏÑ§Ï†ï Î™®Îã¨ÎèÑ ÌÖåÎßà Ï†ÅÏö© */
        [data-theme="light"] .calendar-modal-content,
        [data-theme="light"] .settings-modal-content {
            background: #ffffff !important;
            color: #000000 !important;
        }

        [data-theme="dark"] .calendar-modal-content,
        [data-theme="dark"] .settings-modal-content {
            color: #ffffff !important;
        }

        [data-theme="light"] .settings-section {
            color: #000000 !important;
        }

        [data-theme="dark"] .settings-section {
            color: #ffffff !important;
        }

        [data-theme="light"] .settings-section-title {
            color: #000000 !important;
        }

        [data-theme="dark"] .settings-section-title {
            color: #ffffff !important;
        }

        [data-theme="light"] .settings-section-desc {
            color: #666666 !important;
        }

        [data-theme="dark"] .settings-section-desc {
            color: #999999 !important;
        }
    </style>
    <script>

        // ÌîåÎû´Ìèº Ïó∞Í≤∞ Í¥ÄÎ†® Ìï®ÏàòÎì§
        function connectPlatform(platform) {
            console.log(`Connecting to ${platform}...`);
            // ÌîåÎû´Ìèº Ïó∞Í≤∞ Î°úÏßÅ
        }

        function disconnectPlatform(platform) {
            console.log(`Disconnecting from ${platform}...`);
            // ÌîåÎû´Ìèº Ïó∞Í≤∞ Ìï¥Ï†ú Î°úÏßÅ
        }

        function logoutUser() {
            if (confirm('Ï†ïÎßê Î°úÍ∑∏ÏïÑÏõÉÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                console.log('Logging out...');
                // Î°úÍ∑∏ÏïÑÏõÉ Î°úÏßÅ
                window.location.href = '/logout';
            }
        }

        // ÏÑ§Ï†ï Î™®Îã¨ Í¥ÄÎ†® Ìï®ÏàòÎì§
        function closeSettingsModal() {
            document.getElementById('settings-modal').style.display = 'none';
        }

        // Í∏∞ÌÉÄ ÏÑ§Ï†ï Í¥ÄÎ†® Ìï®ÏàòÎì§
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('settingsLanguageDropdown');
            if (dropdown) {
                dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
            }
        }

        function setLanguage(lang) {
            console.log(`Setting language to: ${lang}`);

            // Ïñ∏Ïñ¥ ÏÑ§Ï†ï Ï†ÄÏû•
            localStorage.setItem('language', lang);

            // Î≤ÑÌäº ÌÖçÏä§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            const toggleBtn = document.getElementById('settingsLanguageToggle');
            if (toggleBtn) {
                const flagSpan = toggleBtn.querySelector('.lang-flag');
                const textSpan = toggleBtn.querySelector('.lang-text');

                if (lang === 'ko') {
                    flagSpan.textContent = 'üá∞üá∑';
                    textSpan.textContent = 'ÌïúÍµ≠Ïñ¥';
                } else if (lang === 'en') {
                    flagSpan.textContent = 'üá∫üá∏';
                    textSpan.textContent = 'English';
                }
            }

            // ÎìúÎ°≠Îã§Ïö¥ Îã´Í∏∞
            toggleLanguageDropdown();
        }

        function navigateToApiKeys() {
            console.log('Navigating to API keys...');

            // Try to get encrypted identifiers from various sources
            let encryptedId = '';
            let encryptedEmail = '';

            if (window.notionFlowConfig && window.notionFlowConfig.encryptedUserId) {
                encryptedId = window.notionFlowConfig.encryptedUserId;
                encryptedEmail = window.notionFlowConfig.encryptedEmail;
            } else if (window.dashboardData && window.dashboardData.encrypted_user_id) {
                encryptedId = window.dashboardData.encrypted_user_id;
                encryptedEmail = window.dashboardData.encrypted_email;
            }

            // Choose the appropriate URL format - encrypted ID/email after api-keys
            let targetUrl = '/dashboard/api-keys';
            if (encryptedId) {
                targetUrl = `/dashboard/api-keys/${encryptedId}`;
            } else if (encryptedEmail) {
                targetUrl = `/dashboard/api-keys/${encryptedEmail}`;
            }

            console.log('Target URL:', targetUrl);

            // ÏÑ§Ï†ï Î™®Îã¨ Îã´Í∏∞ (if it exists)
            if (typeof closeSettingsModal === 'function') {
                closeSettingsModal();
            }

            // API ÌÇ§ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
            window.location.href = targetUrl;
        }

        // ÌÖåÎßà Ï¥àÍ∏∞Ìôî (ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¶âÏãú Ïã§Ìñâ)
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            console.log('Theme initialized:', savedTheme);
        }

        // ThemeManagerÏôÄ Ï∂©ÎèåÌïòÏßÄ ÏïäÎèÑÎ°ù Í∞ÑÎã®Ìûà ÏàòÏ†ï
        function ensureThemeToggleWorks() {
            console.log('üîß Ensuring theme toggle works...');

            // ThemeManagerÍ∞Ä Ïù¥ÎØ∏ Ï≤òÎ¶¨ÌïòÍ≥† ÏûàÏúºÎØÄÎ°ú onclick Ìï∏Îì§Îü¨Îßå ÌôïÏù∏
            const toggle = document.getElementById('theme-toggle');
            if (toggle) {
                console.log('‚úÖ Theme toggle found, ultraForceToggle ready');
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ï¶âÏãú ÌÖåÎßà Ï†ÅÏö©
        initializeTheme();




        // ÏÑ§Ï†ï Î™®Îã¨ Í¥ÄÎ†® Ìï®ÏàòÎì§
        function openSettingsModal() {
            document.getElementById('settings-modal').style.display = 'flex';
        }



        // Ï†ëÌûå ÏÉÅÌÉúÏóêÏÑú ÏïÑÏù¥ÏΩò ÌÅ¥Î¶≠ Ïãú ÏÇ¨Ïù¥ÎìúÎ∞î ÌéºÏπòÍ∏∞ ÎòêÎäî Í∏∞Î≥∏ ÎèôÏûë
        function handleSidebarItemClick(section) {
            const sidebar = document.getElementById('sidebar');
            if (!sidebar) return;

            // ÏÇ¨Ïù¥ÎìúÎ∞îÍ∞Ä Ï†ëÌòÄÏûàÏúºÎ©¥ ÌéºÏπòÍ∏∞Îßå Ìï®
            if (sidebar.classList.contains('collapsed')) {
                toggleSidebar();
                return; // Îã§Î•∏ ÎèôÏûëÏùÄ ÌïòÏßÄ ÏïäÏùå
            }

            // ÌéºÏ≥êÏ†∏ ÏûàÏúºÎ©¥ ÏõêÎûò Í∏∞Îä• Ïã§Ìñâ
            switch (section) {
                case 'profile':
                    if (typeof navigateToSection === 'function') {
                        navigateToSection('profile');
                    } else {
                        window.location.href = '/profile';
                    }
                    break;
                case 'overview':
                    if (typeof navigateToSection === 'function') {
                        navigateToSection('overview');
                    }
                    break;
                case 'sync':
                    if (typeof navigateToSection === 'function') {
                        navigateToSection('sync');
                    }
                    break;
                case 'inbox':
                    if (typeof openInbox === 'function') {
                        openInbox();
                    }
                    break;
                case 'friends':
                    window.location.href = '/friends';
                    break;
                case 'api-keys':
                    if (typeof navigateToApiKeys === 'function') {
                        navigateToApiKeys();
                    }
                    break;
                case 'calendar-list':
                    window.location.href = '/dashboard/calendar-list';
                    break;
                case 'settings':
                    window.location.href = '/dashboard/settings';
                    break;
                default:
                    console.log('Unknown section:', section);
            }
        }

        // ÏÇ¨Ïù¥ÎìúÎ∞î ÌÜ†Í∏Ä Í∏∞Îä• - Í∞ÑÎã®ÌïòÍ≥† ÌôïÏã§Ìïú Î≤ÑÏ†Ñ
        function toggleSidebar() {
            console.log('üîÑ Toggle sidebar clicked');

            const sidebar = document.getElementById('sidebar');
            if (!sidebar) {
                console.error('‚ùå Sidebar not found');
                return;
            }

            // ÌÜ†Í∏Ä Ïã§Ìñâ
            sidebar.classList.toggle('collapsed');
            const isCollapsed = sidebar.classList.contains('collapsed');

            // console.log('‚úÖ Sidebar toggled:', isCollapsed ? 'collapsed' : 'expanded');

            // Î∂ÄÎ™® Ïª®ÌÖåÏù¥ÎÑà ÌÅ¥ÎûòÏä§ ÏóÖÎç∞Ïù¥Ìä∏ (ÏÑ†ÌÉùÏÇ¨Ìï≠)
            const dashboardLayout = document.querySelector('.dashboard-layout');
            if (dashboardLayout) {
                if (isCollapsed) {
                    dashboardLayout.classList.add('sidebar-collapsed');
                } else {
                    dashboardLayout.classList.remove('sidebar-collapsed');
                }
            }

            // ÏïÑÏù¥ÏΩò ÏóÖÎç∞Ïù¥Ìä∏
            updateToggleIcons(isCollapsed);

            // ÌéòÏù¥ÏßÄÎ≥Ñ ÏÉÅÌÉú Ï†ÄÏû•
            const currentPage = getCurrentPageType();
            localStorage.setItem(`sidebar-collapsed-${currentPage}`, isCollapsed);
        }

        // ÌÜ†Í∏Ä ÏïÑÏù¥ÏΩò ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateToggleIcons(isCollapsed) {
            const toggleIcon = document.getElementById('sidebar-toggle-icon');
            const collapsedIcon = document.getElementById('sidebar-collapsed-icon');

            if (toggleIcon && collapsedIcon) {
                if (isCollapsed) {
                    toggleIcon.style.display = 'none';
                    collapsedIcon.style.display = 'block';
                } else {
                    toggleIcon.style.display = 'block';
                    collapsedIcon.style.display = 'none';
                }
                console.log('üéØ Icons updated for collapsed state:', isCollapsed);
            } else {
                console.warn('‚ö†Ô∏è Toggle icons not found');
            }
        }


        // ÌòÑÏû¨ ÌéòÏù¥ÏßÄ ÌÉÄÏûÖ Í∞ÄÏ†∏Ïò§Í∏∞
        function getCurrentPageType() {
            if (document.body.classList.contains('calendar-detail-page') || 
                window.location.pathname.includes('/calendar-detail') ||
                document.querySelector('.calendar-workspace')) {
                return 'calendar-detail';
            } else if (document.body.classList.contains('calendar-list-page') ||
                      window.location.pathname.includes('/calendar-list')) {
                return 'calendar-list';
            } else {
                return 'default';
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï†ÄÏû•Îêú ÏÇ¨Ïù¥ÎìúÎ∞î ÏÉÅÌÉú Î≥µÏõê
        function restoreSidebarState() {
            console.log('üîÑ Restoring sidebar state...');

            const currentPage = getCurrentPageType();
            const isCollapsed = localStorage.getItem(`sidebar-collapsed-${currentPage}`) === 'true';
            const sidebar = document.getElementById('sidebar');

            if (!sidebar) {
                console.warn('‚ö†Ô∏è Sidebar not found during state restoration');
                return;
            }

            if (isCollapsed) {
                sidebar.classList.add('collapsed');
                // console.log('‚úÖ Sidebar restored to collapsed state');

                // Î∂ÄÎ™® Ïª®ÌÖåÏù¥ÎÑàÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
                const dashboardLayout = document.querySelector('.dashboard-layout');
                if (dashboardLayout) {
                    dashboardLayout.classList.add('sidebar-collapsed');
                }

                // ÏïÑÏù¥ÏΩò ÏÉÅÌÉú Î≥µÏõê
                updateToggleIcons(true);
            } else {
                // console.log('‚úÖ Sidebar restored to expanded state');
                updateToggleIcons(false);
            }
        }

        // ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÌïÑ ÏïÑÎ∞îÌÉÄ Î°úÎìú Ìï®Ïàò
        async function loadUserAvatar() {
            try {
                const response = await fetch('/api/profile');
                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.profile) {
                        const avatarUrl = result.profile.avatar_url || '/static/images/default-avatar.svg';
                        const sidebarAvatar = document.getElementById('sidebar-profile-avatar');
                        if (sidebarAvatar) {
                            sidebarAvatar.src = avatarUrl;
                            // console.log('‚úÖ Sidebar avatar loaded:', avatarUrl);
                        }
                    }
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è Could not load user avatar:', error);
                // Í∏∞Î≥∏ ÏïÑÎ∞îÌÉÄ ÏÇ¨Ïö© (Ïù¥ÎØ∏ HTMLÏóê ÏÑ§Ï†ïÎê®)
            }
        }

        // Mini Calendar Functions
        function generateMiniCalendar() {
            const monthGrid = document.getElementById('month-grid');
            if (!monthGrid) return;

            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const today = now.getDate();

            // Get first day of month and total days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();

            monthGrid.innerHTML = '';

            // Previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = daysInPrevMonth - i;
                const cell = document.createElement('div');
                cell.className = 'calendar-cell other-month';
                cell.textContent = day;
                monthGrid.appendChild(cell);
            }

            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('div');
                cell.className = 'calendar-cell';
                if (day === today) {
                    cell.classList.add('today');
                }
                cell.textContent = day;
                cell.onclick = () => handleMiniCalendarClick(year, month, day);
                monthGrid.appendChild(cell);
            }

            // Next month days
            const totalCells = monthGrid.children.length;
            const remainingCells = totalCells % 7 === 0 ? 0 : 7 - (totalCells % 7);
            for (let day = 1; day <= remainingCells; day++) {
                const cell = document.createElement('div');
                cell.className = 'calendar-cell other-month';
                cell.textContent = day;
                monthGrid.appendChild(cell);
            }
        }

        function handleMiniCalendarClick(year, month, day) {
            // Open day modal with selected date
            const selectedDate = new Date(year, month, day);
            
            // If we're on the calendar detail page, open the modal
            if (typeof openDayModal === 'function') {
                openDayModal(selectedDate);
            } else {
                // Otherwise, navigate to calendar detail page with date parameter
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                window.location.href = `/dashboard/calendar-detail?date=${dateStr}`;
            }
        }

        // Add DOM ready event listener
        document.addEventListener('DOMContentLoaded', function () {
            // ÏÇ¨Ïù¥ÎìúÎ∞î ÏÉÅÌÉú Î≥µÏõê
            restoreSidebarState();

            // Í∏∞Î≥∏ ÏÇ¨Ïù¥ÎìúÎ∞î Îß§ÎãàÏ†Ä Ï¥àÍ∏∞Ìôî (sidebar.jsÏóêÏÑú ÏûêÎèôÏúºÎ°ú Ïã§ÌñâÎê®)
            if (typeof SidebarManager !== 'undefined') {
                const sidebarManager = new SidebarManager();
                sidebarManager.init();
            }

            // ÏÇ¨Ïö©Ïûê ÌîÑÎ°úÌïë ÏïÑÎ∞îÌÉÄ Î°úÎìú
            loadUserAvatar();

            // Ensure theme toggle works with ThemeManager
            ensureThemeToggleWorks();

            // Generate mini calendar only on calendar detail page
            const currentPage = getCurrentPageType();
            if (currentPage === 'calendar-detail') {
                console.log('‚úÖ Generating mini calendar for calendar detail page');
                generateMiniCalendar();
            } else {
                console.log('‚ÑπÔ∏è Not generating mini calendar for page type:', currentPage);
            }
        });




    </script>
</div> <!-- sidebar Îã´Í∏∞ -->
</div> <!-- sidebar-container Îã´Í∏∞ -->