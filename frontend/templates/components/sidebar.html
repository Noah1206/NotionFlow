<!-- 
    âœ…âœ…âœ… NOTIONFLOW SIDEBAR v5.0 - FIXED VERSION âœ…âœ…âœ…
    =============================================
    CACHE BUSTER: {{ range(500000, 999999) | random }}
    DEPLOYED: 2025-08-07 01:20 KST - CALENDAR LIST MODE
    STATUS: showCalendarList() FUNCTION READY
    VERSION: 5.0 - DIRECT CALENDAR LIST UI
    =============================================
-->

<!-- ì‚¬ì´ë“œë°” í† ê¸€ ë²„íŠ¼ - ì ‘íŒ ìƒíƒœì—ì„œ ì‚¬ì´ë“œë°” ì¤‘ì•™ì— ìœ„ì¹˜ -->
<button class="sidebar-toggle-btn-floating" id="sidebar-toggle-floating" onclick="toggleSidebar()" data-tooltip="ì‚¬ì´ë“œë°” í¼ì¹˜ê¸°">
    <!-- í–„ë²„ê±° ë©”ë‰´ ì•„ì´ì½˜ (ì ‘íŒ ìƒíƒœ) - ì‚¬ì´ë“œë°” í¼ì¹˜ê¸°ë¥¼ ì˜ë¯¸ -->
    <svg class="sidebar-toggle-open-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
</button>

    <!-- ì‚¬ì´ë“œë°” í—¤ë” - ë¡œê³ ì™€ í† ê¸€ ë²„íŠ¼ -->
    <div class="sidebar-header-container">
        <div class="sidebar-logo">
            <span class="logo-text">NodeFlow</span>
        </div>
        <!-- í† ê¸€ ë²„íŠ¼ì„ í—¤ë” ë‚´ë¶€ë¡œ ì´ë™ - í¼ì³ì§„ ìƒíƒœì—ì„œ ì‚¬ì´ë“œë°” ì ‘ê¸°ìš© -->
        <button class="sidebar-toggle-btn-header" onclick="toggleSidebar()" data-tooltip="ì‚¬ì´ë“œë°” ì ‘ê¸°">
            <!-- X ì•„ì´ì½˜ (í¼ì³ì§„ ìƒíƒœ) - ì‚¬ì´ë“œë°” ì ‘ê¸°ë¥¼ ì˜ë¯¸ -->
            <svg class="sidebar-toggle-close-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
    </div>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ -->
    <nav class="sidebar-nav">
        <!-- ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜ wrapper - ìŠ¤í¬ë¡¤ ê°€ëŠ¥ -->
        <div class="sidebar-main-nav">
            <!-- í”„ë¡œí•„ ì„¹ì…˜ - ìµœìƒë‹¨ -->
            <div class="nav-section">
                <!-- í”„ë¡œí•„ -->
                <div class="nav-item profile-nav-item {{ 'active' if current_page == 'profile' else '' }}"
                    data-section="profile" data-tooltip="í”„ë¡œí•„"
                    onclick="if(typeof navigateToSection === 'function') { navigateToSection('profile'); } else { window.location.href = '/profile'; }">
                    <span class="nav-icon profile-avatar-icon">
                        <img id="sidebar-profile-avatar" src="/static/images/default-avatar.svg" alt="í”„ë¡œí•„"
                            class="sidebar-avatar">
                    </span>
                    <span class="nav-label">í”„ë¡œí•„</span>
                </div>
            </div>

            <!-- ìº˜ë¦°ë” ì„¹ì…˜ -->
            <div class="nav-section">
                <div class="nav-item" data-tooltip="ìº˜ë¦°ë” ëª©ë¡" onclick="window.location.href='/dashboard/calendar-list'">
                    <span class="nav-icon">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                            <line x1="16" y1="2" x2="16" y2="6" />
                            <line x1="8" y1="2" x2="8" y2="6" />
                            <line x1="3" y1="10" x2="21" y2="10" />
                        </svg>
                    </span>
                    <span class="nav-label">ìº˜ë¦°ë”</span>
                </div>
            </div>

            <!-- ê¸°íƒ€ ê¸°ëŠ¥ ì„¹ì…˜ -->
            <div class="nav-section">
                <div class="nav-item {{ 'active' if current_page == 'overview' else '' }}" data-section="overview"
                    data-tooltip="í™ˆ"
                    onclick="if(typeof navigateToSection === 'function') { navigateToSection('overview'); } else { console.log('navigateToSection not loaded yet'); }">
                    <span class="nav-icon">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                            <polyline points="9,22 9,12 15,12 15,22" />
                        </svg>
                    </span>
                    <span class="nav-label">í™ˆ</span>
                </div>

                <div class="nav-item {{ 'active' if current_page == 'sync' else '' }}" data-section="sync"
                    data-tooltip="ë™ê¸°í™” ìƒíƒœ"
                    onclick="if(typeof navigateToSection === 'function') { navigateToSection('sync'); } else { console.log('navigateToSection not loaded yet'); }">
                    <span class="nav-icon">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c2.12 0 4.07.74 5.6 1.99" />
                            <path d="m16 8 5-5" />
                            <path d="m21 3h-5v5" />
                        </svg>
                    </span>
                    <span class="nav-label">ë™ê¸°í™” ìƒíƒœ</span>
                </div>

                <!-- AI ì•Œë¦¼ ìˆ˜ì‹ í•¨ (í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥) -->
                <div class="nav-item" data-tooltip="ìˆ˜ì‹ í•¨" onclick="openInbox()">
                    <span class="nav-icon">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                            <polyline points="22,6 12,13 2,6" />
                        </svg>
                    </span>
                    <span class="nav-label">ìˆ˜ì‹ í•¨</span>
                    <span class="premium-badge">Pro</span>
                </div>
            </div>

            <!-- ì—°ê²° & ê´€ë¦¬ ì„¹ì…˜ -->
            <div class="nav-section">

                <div class="nav-item {{ 'active' if current_page == 'friends' else '' }}" data-section="friends"
                    data-tooltip="ì¹œêµ¬"
                    onclick="if(typeof navigateToSection === 'function') { navigateToSection('friends'); } else { console.log('navigateToSection not loaded yet'); }">
                    <span class="nav-icon">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                            <circle cx="9" cy="7" r="4" />
                            <path d="m22 21-3-3m0 0a5 5 0 1 0-7 0l3 3" />
                        </svg>
                    </span>
                    <span class="nav-label">ì¹œêµ¬</span>
                    <span class="count-badge">0</span>
                </div>

                <div class="nav-item {{ 'active' if current_page == 'api-keys' else '' }}" data-section="api-keys"
                    data-tooltip="API í‚¤ ê´€ë¦¬" onclick="navigateToApiKeys()">
                    <span class="nav-icon">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="7.5" cy="15.5" r="5.5" />
                            <path d="m21 2-9.6 9.6" />
                            <path d="m15.5 7.5 3 3L22 7l-3-3" />
                        </svg>
                    </span>
                    <span class="nav-label">API í‚¤ ê´€ë¦¬</span>
                </div>

            </div>
        </div>
        <!-- ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜ wrapper ë -->

        <!-- í•˜ë‹¨ ê³ ì • ì„¹ì…˜ - ì„¤ì •ë§Œ ë‚¨ê¹€ -->
        <div class="nav-section nav-section-bottom">
            <div class="nav-item {{ 'active' if current_page == 'settings' else '' }}" data-tooltip="ì„¤ì •"
                onclick="openSettingsModal()">
                <span class="nav-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </span>
                <span class="nav-label">ì„¤ì •</span>
            </div>
        </div>
    </nav>
</div>


<!-- ì„¤ì • ëª¨ë‹¬ -->
<div id="settings-modal" class="calendar-modal-overlay" style="display: none;">
    <div class="calendar-modal-content settings-modal-content">
        <div class="calendar-modal-header">
            <h2 class="calendar-modal-title">ì„¤ì •</h2>
            <button class="calendar-modal-close" onclick="closeSettingsModal()">Ã—</button>
        </div>

        <div class="calendar-modal-body">
            <!-- ì–¸ì–´ ì„¤ì • -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">ì–¸ì–´</h3>
                    <p class="settings-section-desc">í‘œì‹œ ì–¸ì–´ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                </div>
                <div class="language-toggle">
                    <button class="language-toggle-btn" id="settingsLanguageToggle" onclick="toggleLanguageDropdown()">
                        <span class="lang-flag">ğŸ‡°ğŸ‡·</span>
                        <span class="lang-text">í•œêµ­ì–´</span>
                        <span class="toggle-arrow">âŒ„</span>
                    </button>
                    <div class="language-dropdown" id="settingsLanguageDropdown" style="display: none;">
                        <div class="language-option" onclick="setLanguage('ko')">
                            <span class="lang-flag">ğŸ‡°ğŸ‡·</span>
                            <span class="lang-name">í•œêµ­ì–´</span>
                        </div>
                        <div class="language-option" onclick="setLanguage('en')">
                            <span class="lang-flag">ğŸ‡ºğŸ‡¸</span>
                            <span class="lang-name">English</span>
                        </div>
                    </div>
                </div>
            </div>


            <!-- í”Œë«í¼ ìƒíƒœ -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">í”Œë«í¼ ìƒíƒœ</h3>
                    <p class="settings-section-desc">ì—°ê²°ëœ í”Œë«í¼ê³¼ ë™ê¸°í™” í˜„í™©</p>
                </div>
                <div class="platform-stats-grid">
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">1,247</div>
                        <div class="platform-stat-label">ë™ê¸°í™”ëœ ì´ë²¤íŠ¸</div>
                        <div class="platform-stat-desc">ì´ë²ˆ ë‹¬ ëª¨ë“  í”Œë«í¼ì—ì„œ ë™ê¸°í™”ëœ ì´ ì´ë²¤íŠ¸ ìˆ˜</div>
                    </div>
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">60%</div>
                        <div class="platform-stat-label">í”Œë«í¼ ì»¤ë²„ë¦¬ì§€</div>
                        <div class="platform-stat-desc">ì—°ê²°ëœ í”Œë«í¼: Notion, Google Calendar, Apple Calendar</div>
                    </div>
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">24.5h</div>
                        <div class="platform-stat-label">ì ˆì•½ëœ ì‹œê°„</div>
                        <div class="platform-stat-desc">ì´ë²ˆ ì£¼ ìë™í™”ë¥¼ í†µí•´ ì ˆì•½ëœ ì˜ˆìƒ ì‹œê°„</div>
                    </div>
                    <div class="platform-stat-card">
                        <div class="platform-stat-number">92%</div>
                        <div class="platform-stat-label">ë™ê¸°í™” ì„±ê³µë¥ </div>
                        <div class="platform-stat-desc">ì§€ë‚œ 30ì¼ê°„ ì„±ê³µì ì¸ ë™ê¸°í™” ë¹„ìœ¨</div>
                    </div>
                </div>
            </div>

            <!-- í”Œë«í¼ ì—°ê²° ê´€ë¦¬ -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">í”Œë«í¼ ì—°ê²° ê´€ë¦¬</h3>
                    <p class="settings-section-desc">ê° í”Œë«í¼ì˜ API í‚¤ë¥¼ ê´€ë¦¬í•˜ê³  ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
                </div>
                <div class="platform-connections">
                    <!-- Notion -->
                    <div class="platform-connection-item">
                        <div class="platform-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M4.459 4.208c.746.606 1.026.56 2.428.466l13.215-.793c.28 0 .047-.28-.046-.326L17.86 1.968c-.42-.326-.981-.7-2.055-.607L3.01 2.295c-.466.046-.56.28-.374.466zm.793 3.08v13.904c0 .747.373 1.027 1.214.98l14.523-.84c.841-.046 1.121-.56 1.121-1.167V6.354c0-.606-.233-.933-.747-.887l-15.177.887c-.56.047-.934.373-.934 1.027zm13.748.327c.093.42 0 .84-.42.888l-.7.14v10.264c-.608.327-1.168.514-1.635.514-.748 0-.935-.234-1.495-.933l-4.577-7.186v6.952L12.21 19s0 .84-1.168.84l-3.222.186c-.093-.186 0-.653.327-.746l.84-.233V9.854L7.822 9.76c-.094-.42.14-1.026.793-1.073l3.456-.233 4.764 7.279v-6.44l-1.215-.139c-.093-.514.28-.887.747-.933zM1.936 1.035l13.31-.98c1.634-.14 2.055-.047 3.082.7l4.249 2.986c.7.513.934.653.934 1.213v16.378c0 1.026-.373 1.634-1.68 1.726l-15.458.934c-.98.047-1.448-.093-1.962-.747l-3.129-4.06c-.56-.747-.793-1.306-.793-1.96V2.667c0-.839.374-1.54 1.447-1.632z" />
                            </svg>
                        </div>
                        <div class="platform-info">
                            <h4>Notion</h4>
                            <p class="platform-status">ì—°ê²°ë˜ì§€ ì•ŠìŒ</p>
                        </div>
                        <button class="platform-connect-btn" onclick="connectPlatform('notion')">ì—°ê²°</button>
                    </div>
                    <!-- Google Calendar -->
                    <div class="platform-connection-item">
                        <div class="platform-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z" />
                            </svg>
                        </div>
                        <div class="platform-info">
                            <h4>Google Calendar</h4>
                            <p class="platform-status connected">ì—°ê²°ë¨</p>
                        </div>
                        <button class="platform-connect-btn connected" onclick="disconnectPlatform('google')">ì—°ê²°
                            í•´ì œ</button>
                    </div>
                    <!-- ì¶”ê°€ í”Œë«í¼ë“¤... -->
                </div>
            </div>

            <!-- ë¹ ë¥¸ ì•¡ì…˜ -->
            <div class="settings-section">
                <div class="settings-section-header">
                    <h3 class="settings-section-title">ë¹ ë¥¸ ì•¡ì…˜</h3>
                </div>
                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="navigateToApiKeys()">
                        <span class="quick-action-icon">ğŸ”‘</span>
                        <span class="quick-action-text">API í‚¤ ê´€ë¦¬</span>
                    </button>
                    <button class="quick-action-btn" onclick="logoutUser()">
                        <span class="quick-action-icon">ğŸšª</span>
                        <span class="quick-action-text">ë¡œê·¸ì•„ì›ƒ</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="calendar-modal-footer">
            <button class="calendar-btn-cancel" onclick="closeSettingsModal()">ë‹«ê¸°</button>
        </div>
    </div>
<style>
    /* ìº˜ë¦°ë” ìƒì„± ëª¨ë‹¬ - ì„¸ë ¨ëœ ë¸”ë™/í™”ì´íŠ¸ ë””ìì¸ */
    .calendar-creation-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 10000;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 1;
        visibility: visible;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .calendar-creation-modal.hidden {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
    }

    .modal-backdrop {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(4px);
        animation: fadeIn 0.2s ease-out;
    }

    .calendar-modal-container {
        position: relative;
        z-index: 10001;
        animation: slideInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .calendar-modal-content {
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
        width: 440px;
        max-width: 90vw;
        max-height: 85vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }

    .calendar-creation-modal.hidden .calendar-modal-content {
        transform: translateY(20px) scale(0.95);
    }

    /* ëª¨ë‹¬ í—¤ë” */
    .calendar-modal-header {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px 24px;
        border-bottom: 1px solid #e5e7eb;
        position: relative;
        background: #fafafa;
    }

    .header-icon {
        display: none;
        /* ì•„ì´ì½˜ ì œê±°í•˜ì—¬ ë” ê¹”ë”í•˜ê²Œ */
    }

    .modal-title {
        font-size: 18px;
        font-weight: 600;
        color: #111827;
        margin: 0;
        text-align: center;
    }

    .close-button {
        width: 32px;
        height: 32px;
        border: none;
        background: transparent;
        border-radius: 6px;
        color: #6b7280;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        position: absolute;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
    }

    .close-button:hover {
        background: #f3f4f6;
        color: #111827;
    }

    /* ëª¨ë‹¬ ë°”ë”” */
    .calendar-modal-body {
        padding: 24px;
        overflow-y: auto;
        flex: 1;
    }

    /* ë™ì  í¼ ìŠ¤íƒ€ì¼ */
    .calendar-form {
        display: flex;
        flex-direction: column;
        gap: 24px;
    }

    .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 20px;
    }

    .form-label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        font-weight: 600;
        color: #374151;
        margin-bottom: 4px;
    }

    .form-label svg {
        opacity: 0.7;
    }

    .form-input {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-size: 16px;
        color: #374151;
        background: #ffffff;
        transition: all 0.2s ease;
        box-sizing: border-box;
    }

    .form-input:focus {
        outline: none;
        border-color: #4285f4;
        box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
    }

    .form-helper {
        font-size: 12px;
        color: #6b7280;
        font-style: italic;
    }

    /* ë¼ë””ì˜¤ ê·¸ë£¹ ìŠ¤íƒ€ì¼ */
    .radio-group {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .radio-option {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 16px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        background: #ffffff;
    }

    .radio-option:hover {
        border-color: #d1d5db;
        background: #f9fafb;
    }

    .radio-option input[type="radio"] {
        display: none;
    }

    .radio-custom {
        width: 20px;
        height: 20px;
        border: 2px solid #d1d5db;
        border-radius: 50%;
        position: relative;
        transition: all 0.2s ease;
    }

    .radio-option input[type="radio"]:checked+.radio-custom {
        border-color: #4285f4;
        background: #4285f4;
    }

    .radio-option input[type="radio"]:checked+.radio-custom::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 8px;
        height: 8px;
        background: white;
        border-radius: 50%;
        transform: translate(-50%, -50%);
    }

    .radio-content {
        display: flex;
        flex-direction: column;
        gap: 2px;
    }

    .radio-title {
        font-size: 13px !important;
        font-weight: 600;
        color: #374151;
    }

    .radio-desc {
        font-size: 11px !important;
        color: #6b7280;
    }

    /* ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ìŠ¤íƒ€ì¼ */
    .color-palette {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 12px;
    }

    .color-palette input[type="radio"] {
        display: none;
    }

    .color-option {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        border: 2px solid transparent;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.1);
    }

    .color-option:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    .color-palette input[type="radio"]:checked+.color-option {
        border-color: #111827;
        transform: scale(1.1);
        box-shadow: 0 0 0 2px #111827;
    }

    .color-palette input[type="radio"]:checked+.color-option::after {
        content: 'âœ“';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-weight: bold;
        font-size: 16px;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .form-actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        margin-top: 32px;
    }

    .btn-secondary,
    .btn-primary {
        padding: 10px 20px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        min-width: 100px;
    }

    .btn-secondary {
        background: #f3f4f6;
        color: #374151;
    }

    .btn-secondary:hover {
        background: #e5e7eb;
    }

    .btn-primary {
        background: #2563eb;
        color: white;
        position: relative;
    }

    .btn-primary:hover {
        background: #3367d6;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
    }

    .btn-primary:disabled {
        background: #9ca3af;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
    }

    .btn-loading {
        display: none;
    }

    .btn-primary.loading .btn-text {
        display: none;
    }

    .btn-primary.loading .btn-loading {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .loading-spinner {
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        from {
            transform: rotate(0deg);
        }

        to {
            transform: rotate(360deg);
        }
    }

    /* ì• ë‹ˆë©”ì´ì…˜ í‚¤í”„ë ˆì„ */
    @keyframes fadeIn {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }

    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(30px) scale(0.95);
        }

        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    @keyframes pulse {

        0%,
        100% {
            transform: scale(1);
        }

        50% {
            transform: scale(1.05);
        }
    }

    @keyframes dots {

        0%,
        20% {
            content: '.';
        }

        40% {
            content: '..';
        }

        60%,
        100% {
            content: '...';
        }
    }

    /* ë‹¤í¬ ëª¨ë“œ ì§€ì› */
    [data-theme="dark"] .calendar-modal-content {
        background: #1f2937;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
    }

    [data-theme="dark"] .modal-title {
        color: #f8fafc;
    }

    [data-theme="dark"] .modal-description {
        color: #94a3b8;
    }

    [data-theme="dark"] .calendar-option {
        background: #334155;
        border-color: #475569;
    }

    [data-theme="dark"] .calendar-option:hover {
        border-color: #64748b;
        background: #3f4f5f;
    }

    [data-theme="dark"] .option-title {
        color: #f8fafc;
    }

    [data-theme="dark"] .option-description {
        color: #94a3b8;
    }

    [data-theme="dark"] .close-button {
        background: #334155;
        color: #94a3b8;
    }

    [data-theme="dark"] .close-button:hover {
        background: #475569;
        color: #f8fafc;
    }

    /* ë°˜ì‘í˜• ë””ìì¸ */
    @media (max-width: 640px) {
        .calendar-modal-content {
            width: 95vw;
            margin: 20px;
        }

        .calendar-modal-header {
            padding: 20px 20px 16px 20px;
        }

        .calendar-modal-body {
            padding: 20px;
        }

        .calendar-option {
            padding: 16px;
            gap: 12px;
        }

        .option-icon {
            width: 48px;
            height: 48px;
        }

        .option-title {
            font-size: 16px;
        }

        .option-description {
            font-size: 13px;
        }
    }

    /* í™•ëŒ€ëœ ì„¤ì • ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .settings-modal-content {
        overflow-y: auto !important;
        max-width: 1200px !important;
        width: 80vw !important;
        height: 85vh !important;
        max-height: none !important;
    }

    /* í”Œë«í¼ ìƒíƒœ ê·¸ë¦¬ë“œ */
    .platform-stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
    }

    .platform-stat-card {
        background: #f5f5f5;
        padding: 1.5rem;
        border-radius: 8px;
        text-align: center;
    }

    [data-theme="dark"] .platform-stat-card {
        background: #2a2a2a;
    }

    .platform-stat-number {
        font-size: 2rem;
        font-weight: 700;
        color: #3b82f6;
        margin-bottom: 0.5rem;
    }

    .platform-stat-label {
        font-size: 0.9rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }

    .platform-stat-desc {
        font-size: 0.8rem;
        color: #666;
        line-height: 1.4;
    }

    /* í”Œë«í¼ ì—°ê²° ê´€ë¦¬ */
    .platform-connections {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-top: 1rem;
    }

    .platform-connection-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background: #f5f5f5;
        border-radius: 8px;
        border: 1px solid #e5e5e5;
    }

    [data-theme="dark"] .platform-connection-item {
        background: #2a2a2a;
        border-color: #444;
    }

    .platform-icon {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: white;
        border-radius: 8px;
        color: #333;
    }

    [data-theme="dark"] .platform-icon {
        background: #1a1a1a;
        color: #fff;
    }

    .platform-info {
        flex: 1;
    }

    .platform-info h4 {
        margin: 0 0 0.25rem 0;
        font-size: 1rem;
    }

    .platform-status {
        font-size: 0.85rem;
        color: #666;
    }

    .platform-status.connected {
        color: #10b981;
    }

    .platform-connect-btn {
        padding: 0.5rem 1rem;
        border: 1px solid #3b82f6;
        background: white;
        color: #3b82f6;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.85rem;
        transition: all 0.2s;
    }

    .platform-connect-btn:hover {
        background: #3b82f6;
        color: white;
    }

    .platform-connect-btn.connected {
        border-color: #dc2626;
        color: #dc2626;
    }

    .platform-connect-btn.connected:hover {
        background: #dc2626;
        color: white;
    }

    /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
    .settings-modal-content::-webkit-scrollbar {
        width: 8px;
    }

    .settings-modal-content::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
    }

    .settings-modal-content::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
    }

    .settings-modal-content::-webkit-scrollbar-thumb:hover {
        background: #555;
    }


    /* ì–¸ì–´ ë“œë¡­ë‹¤ìš´ ìŠ¤íƒ€ì¼ ê°œì„  */
    .language-dropdown {
        background: white !important;
        border: 1px solid #ddd !important;
        border-radius: 8px !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
        position: absolute !important;
        top: 100% !important;
        left: 0 !important;
        right: 0 !important;
        z-index: 1000 !important;
        margin-top: 4px !important;
    }

    [data-theme="dark"] .language-dropdown {
        background: #2a2a2a !important;
        border-color: #444 !important;
    }

    .language-option {
        display: flex !important;
        align-items: center !important;
        gap: 8px !important;
        padding: 12px !important;
        cursor: pointer !important;
        transition: background-color 0.2s !important;
    }

    .language-option:hover {
        background-color: #f5f5f5 !important;
    }

    [data-theme="dark"] .language-option:hover {
        background-color: #333 !important;
    }

    /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ì„¹ì…˜ ìœ„ì¹˜ ì¡°ì • */
    .nav-section-bottom {
        margin-top: -12px !important;
    }

    .nav-section-bottom .nav-item {
        padding-top: 8px !important;
        padding-bottom: 8px !important;
    }

    /* ì‚¬ì´ë“œë°” í”„ë¡œí•„ ì•„ë°”íƒ€ ìŠ¤íƒ€ì¼ */
    .profile-avatar-icon {
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 0 !important;
        width: 32px !important;
        height: 32px !important;
        position: relative !important;
    }

    .sidebar-avatar {
        width: 28px !important;
        height: 28px !important;
        min-width: 28px !important;
        min-height: 28px !important;
        max-width: 28px !important;
        max-height: 28px !important;
        border-radius: 50% !important;
        object-fit: cover !important;
        border: 2px solid rgba(255, 255, 255, 0.2) !important;
        transition: all 0.2s ease !important;
        display: block !important;
        flex-shrink: 0 !important;
    }

    .profile-nav-item:hover .sidebar-avatar {
        border-color: rgba(255, 255, 255, 0.4) !important;
        transform: scale(1.05) !important;
    }

    .profile-nav-item.active .sidebar-avatar {
        border-color: rgba(255, 255, 255, 0.6) !important;
        box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2) !important;
    }

    /* ì ‘íŒ ìƒíƒœì—ì„œ ì•„ë°”íƒ€ ì¤‘ì•™ ì •ë ¬ */
    .sidebar.collapsed .profile-avatar-icon {
        margin: 0 auto !important;
        width: 36px !important;
        height: 36px !important;
    }

    .sidebar.collapsed .sidebar-avatar {
        width: 32px !important;
        height: 32px !important;
        min-width: 32px !important;
        min-height: 32px !important;
        max-width: 32px !important;
        max-height: 32px !important;
    }

    /* ì‚¬ì´ë“œë°” í—¤ë” ì»¨í…Œì´ë„ˆ */
    .sidebar-header-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 16px 8px 16px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        margin-bottom: 8px;
    }

    /* NotionFlow ë¡œê³  í…ìŠ¤íŠ¸ */
    .sidebar-logo {
        display: flex;
        align-items: center;
    }

    .logo-text {
        font-size: 18px;
        font-weight: 700;
        color: rgba(255, 255, 255, 0.9);
        letter-spacing: -0.02em;
        user-select: none;
    }

    .sidebar-toggle-btn-internal {
        width: 32px;
        height: 32px;
        border: none;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 6px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        color: rgba(255, 255, 255, 0.7);
    }

    .sidebar-toggle-btn-internal:hover {
        background: rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.9);
        transform: scale(1.05);
    }

    .sidebar-toggle-btn-internal svg {
        width: 16px;
        height: 16px;
        transition: transform 0.2s ease;
    }

    /* ì ‘íŒ ìƒíƒœì—ì„œëŠ” ë¡œê³  ìˆ¨ê¸°ê³  í† ê¸€ ë²„íŠ¼ ì¤‘ì•™ ì •ë ¬ */
    .sidebar.collapsed .sidebar-header-container {
        justify-content: center;
        padding: 12px 8px 8px 8px;
    }

    .sidebar.collapsed .sidebar-logo {
        display: none;
    }

    .sidebar.collapsed .sidebar-toggle-btn-internal {
        background: rgba(255, 255, 255, 0.15);
    }

    /* ì•„ì´ì½˜ í‘œì‹œ/ìˆ¨ê¹€ */
    #sidebar-toggle-icon {
        display: block;
    }

    #sidebar-collapsed-icon {
        display: none;
    }

    .sidebar.collapsed #sidebar-toggle-icon {
        display: none;
    }

    .sidebar.collapsed #sidebar-collapsed-icon {
        display: block;
    }

    /* ë‹¤í¬ ëª¨ë“œì—ì„œ í† ê¸€ ë²„íŠ¼ border ì œê±° */
    [data-theme="dark"] .sidebar-toggle-btn-internal {
        border: none !important;
    }

    /* ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ìŠ¤íƒ€ì¼ */
    .context-menu {
        position: fixed;
        background: white;
        border: 1px solid #e5e5e5;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        z-index: 10001;
        min-width: 150px;
        padding: 4px 0;
    }

    .context-menu-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        cursor: pointer;
        font-size: 14px;
        color: #333;
        transition: background-color 0.2s ease;
    }

    .context-menu-item:hover {
        background-color: #f5f5f5;
    }

    .context-menu-item-danger {
        color: #dc2626;
    }

    .context-menu-item-danger:hover {
        background-color: #fef2f2;
    }

    .context-menu-item svg {
        flex-shrink: 0;
    }

    /* ìº˜ë¦°ë” ì•„ì´í…œ ìš°í´ë¦­ í‘œì‹œ */
    .calendar-item {
        position: relative;
    }

    .calendar-item.context-active {
        background-color: rgba(66, 133, 244, 0.1);
    }

    /* ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
    }

    .modal-container {
        background: white;
        border-radius: 12px;
        max-width: 400px;
        width: 90%;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem 2rem;
        border-bottom: 1px solid #e5e5e5;
    }

    .modal-header h3 {
        margin: 0;
        font-size: 1.25rem;
        font-weight: 600;
    }

    .modal-close {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: #666;
        padding: 0.5rem;
        line-height: 1;
    }

    .modal-body {
        padding: 2rem;
    }

    .modal-footer {
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
        padding: 1.5rem 2rem;
        border-top: 1px solid #e5e5e5;
    }

    .form-group {
        margin-bottom: 1rem;
    }

    .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: #333;
    }

    .form-group input {
        width: 100%;
        padding: 0.75rem;
        border: 2px solid #e5e5e5;
        border-radius: 6px;
        font-size: 1rem;
        transition: border-color 0.2s ease;
        box-sizing: border-box;
    }

    .form-group input:focus {
        outline: none;
        border-color: #4285f4;
    }

    .btn {
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 6px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-primary {
        background: #4285f4;
        color: white;
    }

    .btn-primary:hover {
        background: #3367d6;
    }

    .btn-secondary {
        background: #f0f0f0;
        color: #333;
    }

    .btn-secondary:hover {
        background: #e5e5e5;
    }

    .loading-spinner {
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        from {
            transform: rotate(0deg);
        }

        to {
            transform: rotate(360deg);
        }
    }

    /* í…Œë§ˆ ê°•ì œ ì ìš© ìŠ¤íƒ€ì¼ */
    [data-theme="light"] body,
    [data-theme="light"] .main-content,
    [data-theme="light"] .dashboard-section {
        background: #ffffff !important;
        color: #000000 !important;
    }

    [data-theme="dark"] body,
    [data-theme="dark"] .main-content,
    [data-theme="dark"] .dashboard-section {
        background: #141414 !important;
        color: #ffffff !important;
    }

    /* ğŸ¨ Floating ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ ê°•ì œ ì ìš© */
    [data-theme="light"] .sidebar {
        background: rgba(248, 249, 250, 0.95) !important;
        border: 1px solid rgba(233, 236, 239, 0.8) !important;
        border-radius: 12px !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08), 0 4px 16px rgba(0, 0, 0, 0.04) !important;
        backdrop-filter: blur(20px) !important;
        margin: 16px 0 16px 16px !important;
        height: calc(100vh - 32px) !important;
        width: 240px !important;
    }

    [data-theme="dark"] .sidebar {
        background: rgba(26, 26, 26, 0.95) !important;
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
        border-radius: 12px !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.24), 0 4px 16px rgba(0, 0, 0, 0.12) !important;
        backdrop-filter: blur(20px) !important;
        margin: 16px 0 16px 16px !important;
        height: calc(100vh - 32px) !important;
        width: 240px !important;
    }

    /* ì¶•ì†Œ ìƒíƒœ */
    .sidebar.collapsed {
        width: 72px !important;
    }

    /* ì„¤ì • ëª¨ë‹¬ë„ í…Œë§ˆ ì ìš© */
    [data-theme="light"] .calendar-modal-content,
    [data-theme="light"] .settings-modal-content {
        background: #ffffff !important;
        color: #000000 !important;
    }

    [data-theme="dark"] .calendar-modal-content,
    [data-theme="dark"] .settings-modal-content {
        color: #ffffff !important;
    }

    [data-theme="light"] .settings-section {
        color: #000000 !important;
    }

    [data-theme="dark"] .settings-section {
        color: #ffffff !important;
    }

    [data-theme="light"] .settings-section-title {
        color: #000000 !important;
    }

    [data-theme="dark"] .settings-section-title {
        color: #ffffff !important;
    }

    [data-theme="light"] .settings-section-desc {
        color: #666666 !important;
    }

    [data-theme="dark"] .settings-section-desc {
        color: #999999 !important;
    }
</style>
<script>

    // í”Œë«í¼ ì—°ê²° ê´€ë ¨ í•¨ìˆ˜ë“¤
    function connectPlatform(platform) {
        console.log(`Connecting to ${platform}...`);
        // í”Œë«í¼ ì—°ê²° ë¡œì§
    }

    function disconnectPlatform(platform) {
        console.log(`Disconnecting from ${platform}...`);
        // í”Œë«í¼ ì—°ê²° í•´ì œ ë¡œì§
    }

    function logoutUser() {
        if (confirm('ì •ë§ ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            console.log('Logging out...');
            // ë¡œê·¸ì•„ì›ƒ ë¡œì§
            window.location.href = '/logout';
        }
    }

    // ì„¤ì • ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
    function closeSettingsModal() {
        document.getElementById('settings-modal').style.display = 'none';
    }

    // ê¸°íƒ€ ì„¤ì • ê´€ë ¨ í•¨ìˆ˜ë“¤
    function toggleLanguageDropdown() {
        const dropdown = document.getElementById('settingsLanguageDropdown');
        if (dropdown) {
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }
    }

    function setLanguage(lang) {
        console.log(`Setting language to: ${lang}`);

        // ì–¸ì–´ ì„¤ì • ì €ì¥
        localStorage.setItem('language', lang);

        // ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        const toggleBtn = document.getElementById('settingsLanguageToggle');
        if (toggleBtn) {
            const flagSpan = toggleBtn.querySelector('.lang-flag');
            const textSpan = toggleBtn.querySelector('.lang-text');

            if (lang === 'ko') {
                flagSpan.textContent = 'ğŸ‡°ğŸ‡·';
                textSpan.textContent = 'í•œêµ­ì–´';
            } else if (lang === 'en') {
                flagSpan.textContent = 'ğŸ‡ºğŸ‡¸';
                textSpan.textContent = 'English';
            }
        }

        // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
        toggleLanguageDropdown();
    }

    function navigateToApiKeys() {
        console.log('Navigating to API keys...');

        // Try to get encrypted identifiers from various sources
        let encryptedId = '';
        let encryptedEmail = '';

        if (window.notionFlowConfig && window.notionFlowConfig.encryptedUserId) {
            encryptedId = window.notionFlowConfig.encryptedUserId;
            encryptedEmail = window.notionFlowConfig.encryptedEmail;
        } else if (window.dashboardData && window.dashboardData.encrypted_user_id) {
            encryptedId = window.dashboardData.encrypted_user_id;
            encryptedEmail = window.dashboardData.encrypted_email;
        }

        // Choose the appropriate URL format - encrypted ID/email after api-keys
        let targetUrl = '/dashboard/api-keys';
        if (encryptedId) {
            targetUrl = `/dashboard/api-keys/${encryptedId}`;
        } else if (encryptedEmail) {
            targetUrl = `/dashboard/api-keys/${encryptedEmail}`;
        }

        console.log('Target URL:', targetUrl);

        // ì„¤ì • ëª¨ë‹¬ ë‹«ê¸° (if it exists)
        if (typeof closeSettingsModal === 'function') {
            closeSettingsModal();
        }

        // API í‚¤ í˜ì´ì§€ë¡œ ì´ë™
        window.location.href = targetUrl;
    }

    // í…Œë§ˆ ì´ˆê¸°í™” (í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ ì‹¤í–‰)
    function initializeTheme() {
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        console.log('Theme initialized:', savedTheme);
    }

    // ThemeManagerì™€ ì¶©ëŒí•˜ì§€ ì•Šë„ë¡ ê°„ë‹¨íˆ ìˆ˜ì •
    function ensureThemeToggleWorks() {
        console.log('ğŸ”§ Ensuring theme toggle works...');

        // ThemeManagerê°€ ì´ë¯¸ ì²˜ë¦¬í•˜ê³  ìˆìœ¼ë¯€ë¡œ onclick í•¸ë“¤ëŸ¬ë§Œ í™•ì¸
        const toggle = document.getElementById('theme-toggle');
        if (toggle) {
            console.log('âœ… Theme toggle found, ultraForceToggle ready');
        }
    }

    // í˜ì´ì§€ ë¡œë“œ ì¦‰ì‹œ í…Œë§ˆ ì ìš©
    initializeTheme();




    // ì„¤ì • ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
    function openSettingsModal() {
        document.getElementById('settings-modal').style.display = 'flex';
    }



    // ì‚¬ì´ë“œë°” í† ê¸€ ê¸°ëŠ¥ - ê°„ë‹¨í•˜ê³  í™•ì‹¤í•œ ë²„ì „
    function toggleSidebar() {
        console.log('ğŸ”„ Toggle sidebar clicked');

        const sidebar = document.getElementById('sidebar');
        if (!sidebar) {
            console.error('âŒ Sidebar not found');
            return;
        }

        // í† ê¸€ ì‹¤í–‰
        sidebar.classList.toggle('collapsed');
        const isCollapsed = sidebar.classList.contains('collapsed');

        // console.log('âœ… Sidebar toggled:', isCollapsed ? 'collapsed' : 'expanded');

        // ë¶€ëª¨ ì»¨í…Œì´ë„ˆ í´ë˜ìŠ¤ ì—…ë°ì´íŠ¸ (ì„ íƒì‚¬í•­)
        const dashboardLayout = document.querySelector('.dashboard-layout');
        if (dashboardLayout) {
            if (isCollapsed) {
                dashboardLayout.classList.add('sidebar-collapsed');
            } else {
                dashboardLayout.classList.remove('sidebar-collapsed');
            }
        }

        // ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
        updateToggleIcons(isCollapsed);

        // ìƒíƒœ ì €ì¥
        localStorage.setItem('sidebar-collapsed', isCollapsed);
    }

    // í† ê¸€ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateToggleIcons(isCollapsed) {
        const toggleIcon = document.getElementById('sidebar-toggle-icon');
        const collapsedIcon = document.getElementById('sidebar-collapsed-icon');

        if (toggleIcon && collapsedIcon) {
            if (isCollapsed) {
                toggleIcon.style.display = 'none';
                collapsedIcon.style.display = 'block';
            } else {
                toggleIcon.style.display = 'block';
                collapsedIcon.style.display = 'none';
            }
            console.log('ğŸ¯ Icons updated for collapsed state:', isCollapsed);
        } else {
            console.warn('âš ï¸ Toggle icons not found');
        }
    }


    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ì‚¬ì´ë“œë°” ìƒíƒœ ë³µì›
    function restoreSidebarState() {
        console.log('ğŸ”„ Restoring sidebar state...');

        const isCollapsed = localStorage.getItem('sidebar-collapsed') === 'true';
        const sidebar = document.getElementById('sidebar');

        if (!sidebar) {
            console.warn('âš ï¸ Sidebar not found during state restoration');
            return;
        }

        if (isCollapsed) {
            sidebar.classList.add('collapsed');
            // console.log('âœ… Sidebar restored to collapsed state');

            // ë¶€ëª¨ ì»¨í…Œì´ë„ˆë„ ì—…ë°ì´íŠ¸
            const dashboardLayout = document.querySelector('.dashboard-layout');
            if (dashboardLayout) {
                dashboardLayout.classList.add('sidebar-collapsed');
            }

            // ì•„ì´ì½˜ ìƒíƒœ ë³µì›
            updateToggleIcons(true);
        } else {
            // console.log('âœ… Sidebar restored to expanded state');
            updateToggleIcons(false);
        }
    }

    // ì‚¬ìš©ì í”„ë¡œí•„ ì•„ë°”íƒ€ ë¡œë“œ í•¨ìˆ˜
    async function loadUserAvatar() {
        try {
            const response = await fetch('/api/profile');
            if (response.ok) {
                const result = await response.json();
                if (result.success && result.profile) {
                    const avatarUrl = result.profile.avatar_url || '/static/images/default-avatar.svg';
                    const sidebarAvatar = document.getElementById('sidebar-profile-avatar');
                    if (sidebarAvatar) {
                        sidebarAvatar.src = avatarUrl;
                        // console.log('âœ… Sidebar avatar loaded:', avatarUrl);
                    }
                }
            }
        } catch (error) {
            console.warn('âš ï¸ Could not load user avatar:', error);
            // ê¸°ë³¸ ì•„ë°”íƒ€ ì‚¬ìš© (ì´ë¯¸ HTMLì— ì„¤ì •ë¨)
        }
    }

    // Add DOM ready event listener
    document.addEventListener('DOMContentLoaded', function () {
        // ì‚¬ì´ë“œë°” ìƒíƒœ ë³µì›
        restoreSidebarState();

        // ê¸°ë³¸ ì‚¬ì´ë“œë°” ë§¤ë‹ˆì € ì´ˆê¸°í™” (sidebar.jsì—ì„œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë¨)
        if (typeof SidebarManager !== 'undefined') {
            const sidebarManager = new SidebarManager();
            sidebarManager.init();
        }

        // ì‚¬ìš©ì í”„ë¡œí•‘ ì•„ë°”íƒ€ ë¡œë“œ
        loadUserAvatar();

        // Ensure theme toggle works with ThemeManager
        ensureThemeToggleWorks();
    });




</script>
    </div> <!-- sidebar ë‹«ê¸° -->
</div> <!-- sidebar-container ë‹«ê¸° -->
